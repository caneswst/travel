<!DOCTYPE html>
<html lang="zh-HK">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æœ¬åœ°æ—…éŠè¡Œç¨‹è¦åŠƒç¶²ç«™</title>
    <style>
        * {
            box-sizing: border-box;
        }
        body {
            font-family: 'Microsoft JhengHei', 'PingFang TC', Arial, sans-serif;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            color: #333;
            min-height: 100vh;
        }
        .container {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }
        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 10px;
            font-size: 2.5em;
        }
        .subtitle {
            text-align: center;
            color: #7f8c8d;
            margin-bottom: 30px;
            font-size: 1.1em;
        }
        .input-section {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        input, button {
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            transition: all 0.3s;
        }
        input {
            flex: 1;
            background-color: #f8f9fa;
        }
        input:focus {
            outline: none;
            border-color: #3498db;
            background-color: white;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
        }
        button {
            background: linear-gradient(to right, #3498db, #2980b9);
            color: white;
            border: none;
            cursor: pointer;
            font-weight: bold;
            white-space: nowrap;
        }
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 7px 14px rgba(52, 152, 219, 0.3);
        }
        button:active {
            transform: translateY(0);
        }
        .location-status {
            padding: 15px;
            margin: 15px 0;
            border-radius: 8px;
            font-size: 14px;
        }
        .success { background: #d4edda; color: #155724; border-left: 4px solid #28a745; }
        .warning { background: #fff3cd; color: #856404; border-left: 4px solid #ffc107; }
        .error { background: #f8d7da; color: #721c24; border-left: 4px solid #dc3545; }
        .info { background: #d1ecf1; color: #0c5460; border-left: 4px solid #17a2b8; }
        .results-container {
            margin-top: 30px;
        }
        .section {
            background: white;
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            border-top: 5px solid;
            transition: transform 0.3s;
        }
        .section:hover {
            transform: translateY(-5px);
        }
        .section-routes { border-top-color: #3498db; }
        .section-rankings { border-top-color: #e74c3c; }
        .section-social { border-top-color: #9b59b6; }
        .section-booking { border-top-color: #2ecc71; }
        h2 {
            color: #2c3e50;
            margin-top: 0;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        h2 i {
            font-size: 1.5em;
        }
        .social-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        .social-item {
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            transition: all 0.3s;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .social-item:hover {
            background: #e9ecef;
            transform: translateX(5px);
        }
        .social-icon {
            font-size: 1.5em;
            margin-right: 10px;
            width: 30px;
            text-align: center;
        }
        .social-name {
            flex-grow: 1;
            display: flex;
            align-items: center;
        }
        a {
            color: #3498db;
            text-decoration: none;
            font-weight: 500;
            padding: 5px 10px;
            border-radius: 4px;
            transition: all 0.2s;
            white-space: nowrap;
        }
        a:hover {
            background: #3498db;
            color: white;
            text-decoration: none;
        }
        .category-tag {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            margin-right: 8px;
        }
        .tag-attractions { background: #ffebee; color: #c62828; }
        .tag-shopping { background: #fff3e0; color: #ef6c00; }
        .tag-food { background: #e8f5e9; color: #2e7d32; }
        .tag-accommodation { background: #e3f2fd; color: #1565c0; }
        .recommendations-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 15px;
            margin-top: 15px;
            margin-bottom: 25px;
        }
        .recommendation-item {
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            transition: all 0.3s;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .recommendation-item:hover {
            background: #e9ecef;
            transform: translateX(5px);
        }
        .loading {
            text-align: center;
            padding: 30px;
            color: #7f8c8d;
            font-size: 1.2em;
        }
        .loading:after {
            content: '...';
            animation: dots 1.5s steps(4, end) infinite;
        }
        @keyframes dots {
            0%, 20% { content: '.'; }
            40% { content: '..'; }
            60%, 100% { content: '...'; }
        }
        .no-api-note {
            background: #e8f4fc;
            padding: 20px;
            border-radius: 8px;
            margin: 15px 0;
            line-height: 1.6;
            border-left: 4px solid #3498db;
        }
        .popular-destinations {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 15px;
            margin-bottom: 25px;
        }
        .popular-btn {
            padding: 8px 15px;
            background: #f1f2f6;
            border: 1px solid #ddd;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s;
        }
        .popular-btn:hover {
            background: #3498db;
            color: white;
            border-color: #3498db;
        }
        .feature-list {
            display: flex;
            justify-content: space-around;
            margin: 30px 0;
            text-align: center;
            flex-wrap: wrap;
            gap: 20px;
        }
        .feature {
            flex: 1;
            min-width: 200px;
            padding: 20px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }
        .feature-icon {
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        .feature h3 {
            margin-top: 0;
            color: #2c3e50;
        }
        .social-colors {
            color: #fff;
            padding: 3px 8px;
            border-radius: 4px;
            font-size: 0.8em;
        }
        .douyin-color { background: linear-gradient(to right, #FE2C55, #25F4EE); }
        .xiaohongshu-color { background: #FF2442; }
        .bilibili-color { background: #FB7299; }
        .facebook-color { background: #1877F2; }
        .threads-color { background: #000000; }
        .youtube-color { background: #FF0000; }
        .instagram-color { background: linear-gradient(45deg, #405DE6, #5851DB, #833AB4, #C13584, #E1306C, #FD1D1D); }
        .twitter-color { background: #1DA1F2; }
        .macau-theme {
            background: linear-gradient(135deg, #f5f7fa 0%, #d1e7ff 100%);
        }
        .macau-header {
            color: #e63946;
            text-shadow: 1px 1px 3px rgba(0,0,0,0.1);
        }
        @media (max-width: 768px) {
            .input-section {
                flex-direction: column;
            }
            .recommendations-grid, .social-grid {
                grid-template-columns: 1fr;
            }
            .feature-list {
                flex-direction: column;
            }
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
</head>
<body class="macau-theme">
    <div class="container">
        <h1 class="macau-header"><i class="fas fa-plane-departure"></i> æ™ºèƒ½æ—…éŠè¡Œç¨‹è¦åŠƒ</h1>
        <div class="subtitle">å®Œå…¨æœ¬åœ°é‹è¡Œ Â· ç„¡éœ€APIé‡‘é‘° Â· é»˜èªä½ç½®ï¼šæ¾³é–€æ°¹ä»”ä¸­å¤®å…¬åœ’ Â· å³æ™‚è·¯ç·šè¦åŠƒ</div>
        
        <div class="no-api-note">
            <i class="fas fa-info-circle"></i> æœ¬å·¥å…·å®Œå…¨åœ¨æ‚¨çš„ç€è¦½å™¨ä¸­é‹è¡Œï¼Œç„¡éœ€ä»»ä½•APIé‡‘é‘°ã€‚æ‰€æœ‰æ•¸æ“šå‡ä¾†è‡ªå…¬é–‹ç¶²çµ¡è³‡æºã€‚
        </div>
        
        <div class="feature-list">
            <div class="feature">
                <div class="feature-icon">ğŸ“</div>
                <h3>æ¾³é–€å‡ºç™¼</h3>
                <p>é»˜èªå¾æ¾³é–€æ°¹ä»”ä¸­å¤®å…¬åœ’å‡ºç™¼</p>
            </div>
            <div class="feature">
                <div class="feature-icon">ğŸ—ºï¸</div>
                <h3>è·¯ç·šè¦åŠƒ</h3>
                <p>æä¾›æ­¥è¡Œã€å…¬äº¤å’Œè‡ªé§•è·¯ç·š</p>
            </div>
            <div class="feature">
                <div class="feature-icon">ğŸ†</div>
                <h3>ç†±é–€æ¨è–¦</h3>
                <p>æ¨è–¦ç•¶åœ°ç†±é–€æ™¯é»èˆ‡æ´»å‹•</p>
            </div>
            <div class="feature">
                <div class="feature-icon">ğŸ“±</div>
                <h3>ç¤¾ç¾¤ç†±é»</h3>
                <p>æŸ¥çœ‹ç¤¾äº¤åª’é«”ä¸Šçš„ç†±é–€å…§å®¹</p>
            </div>
        </div>
        
        <div class="input-section">
            <input type="text" id="destination" placeholder="è«‹è¼¸å…¥ç›®çš„åœ°ï¼ˆä¾‹å¦‚ï¼šæ¾³é–€å¤§ä¸‰å·´ã€é¦™æ¸¯è¿ªå£«å°¼ã€æ±äº¬æ™´ç©ºå¡”ï¼‰" onkeypress="handleKeyPress(event)">
            <button onclick="planTrip()" id="plan-btn"><i class="fas fa-search"></i> è¦åŠƒè¡Œç¨‹</button>
        </div>
        
        <div class="popular-destinations">
            <div>ç†±é–€ç›®çš„åœ°ï¼š</div>
            <button class="popular-btn" onclick="setDestination('æ¾³é–€å¤§ä¸‰å·´ç‰ŒåŠ')">æ¾³é–€å¤§ä¸‰å·´</button>
            <button class="popular-btn" onclick="setDestination('æ¾³é–€å¨å°¼æ–¯äºº')">æ¾³é–€å¨å°¼æ–¯äºº</button>
            <button class="popular-btn" onclick="setDestination('é¦™æ¸¯è¿ªå£«å°¼æ¨‚åœ’')">é¦™æ¸¯è¿ªå£«å°¼</button>
            <button class="popular-btn" onclick="setDestination('æ±äº¬æ™´ç©ºå¡”')">æ±äº¬æ™´ç©ºå¡”</button>
            <button class="popular-btn" onclick="setDestination('å°åŒ—101')">å°åŒ—101</button>
        </div>
        
        <div id="location-status" class="location-status info">
            <i class="fas fa-sync fa-spin"></i> æ­£åœ¨ç²å–æ‚¨çš„ä½ç½®...ï¼ˆè¶…æ™‚å°‡ä½¿ç”¨æ¾³é–€æ°¹ä»”ä¸­å¤®å…¬åœ’ï¼‰
        </div>
        
        <div id="results" class="results-container"></div>
    </div>

    <script>
        let userPosition = null;
        // æ¾³é–€æ°¹ä»”ä¸­å¤®å…¬åœ’åº§æ¨™
        const DEFAULT_POSITION = { lat: 22.1568, lng: 113.5610 };
        const DEFAULT_LOCATION_NAME = "æ¾³é–€æ°¹ä»”ä¸­å¤®å…¬åœ’";
        
        let popularDestinations = {
            'æ¾³é–€': {
                attractions: ['å¤§ä¸‰å·´ç‰ŒåŠ', 'æ¾³é–€æ—…éŠå¡”', 'å¨å°¼æ–¯äººåº¦å‡æ‘', 'åª½é–£å»Ÿ', 'è­°äº‹äº­å‰åœ°', 'é¾ç’°è‘¡éŸ»', 'æ¾³é–€ç§‘å­¸é¤¨', 'æ¼äººç¢¼é ­', 'è·¯ç’°å³¶', 'æ¾³é–€éŠ€æ²³'],
                shopping: ['å¨å°¼æ–¯äººå¤§é‹æ²³è³¼ç‰©ä¸­å¿ƒ', 'æ–°å…«ä½°ä¼´', 'é‡‘æ²™åŸä¸­å¿ƒ', 'æ–°æ¿ å¤©åœ°', 'æ°¸åˆ©æ¾³é–€', 'å£¹è™Ÿå»£å ´', 'æ¾³é–€DFSå…ç¨…åº—', 'å®˜ä¹Ÿè¡—', 'å¤§ä¸‰å·´æ‰‹ä¿¡è¡—', 'æ°´å‘å°¾è¡—'],
                food: ['å®‰å¾·é­¯é¤…åº—è›‹æ’»', 'ç‘ªå˜‰çƒˆè›‹æ’»', 'å¤§åˆ©ä¾†è¨˜è±¬æ‰’åŒ…', 'é»ƒæè¨˜ç²¥éºµ', 'é™³å…‰è¨˜ç‡’è‡˜', 'ç¾©é †ç‰›å¥¶å…¬å¸', 'é¾è¯èŒ¶æ¨“', 'æ¾³é–€è‘¡åœ‹é¤å»³', 'è­šå®¶é­šç¿…', 'è«ç¾©è¨˜æ¦´æ§¤é›ªç³•'],
                accommodation: ['æ¾³é–€å¨å°¼æ–¯äººé…’åº—', 'æ¾³é–€éŠ€æ²³é…’åº—', 'æ–°æ¿ å½±åŒ¯', 'æ°¸åˆ©çš‡å®®', 'æ¾³é–€ç¾é«˜æ¢…', 'æ¾³é–€é‡‘æ²™åŸä¸­å¿ƒåº·èŠå¾·é…’åº—', 'æ¾³é–€å·´é»äºº', 'æ¾³é–€åå…­æµ¦ç´¢è²ç‰¹å¤§é…’åº—', 'æ¾³é–€å‹µåº­æµ·æ™¯é…’åº—', 'æ¾³é–€çš‡å† å‡æ—¥é…’åº—']
            },
            'é¦™æ¸¯': {
                attractions: ['é¦™æ¸¯è¿ªå£«å°¼æ¨‚åœ’', 'å¤ªå¹³å±±é ‚', 'ç¶­å¤šåˆ©äºæ¸¯', 'æµ·æ´‹å…¬åœ’', 'æ˜Ÿå…‰å¤§é“', 'é¦™æ¸¯æ•…å®®æ–‡åŒ–åšç‰©é¤¨', 'å»Ÿè¡—å¤œå¸‚', 'è˜­æ¡‚åŠ', 'é¦™æ¸¯æµ·æ´‹å…¬åœ’', 'å¤©æ˜Ÿå°è¼ª'],
                shopping: ['éŠ…é‘¼ç£æ™‚ä»£å»£å ´', 'å°–æ²™å’€æµ·æ¸¯åŸ', 'æ—ºè§’æœ—è±ªåŠ', 'ä¸­ç’°IFC', 'å¤ªå¤å»£å ´', 'æ²™ç”°æ–°åŸå¸‚å»£å ´', 'æ±è–ˆåŸååº—å€‰', 'APMå•†å ´', 'K11 MUSEA', 'å¸Œæ…å»£å ´'],
                food: ['éè¨˜é…’å®¶', 'è˜­èŠ³åœ’çµ²è¥ªå¥¶èŒ¶', 'ä¹è¨˜ç‰›è…©', 'æ·»å¥½é‹é»å¿ƒ', 'æ¾³æ´²ç‰›å¥¶å…¬å¸', 'ä¸€æ¨‚ç‡’éµ', 'æ³°æ˜Œé¤…å®¶è›‹æ’»', 'éº¥å¥€é›²åéºµä¸–å®¶', 'ä½³ä½³ç”œå“', 'æ©‹åº•è¾£èŸ¹'],
                accommodation: ['é¦™æ¸¯åŠå³¶é…’åº—', 'é¦™æ¸¯éº—æ€å¡çˆ¾é “é…’åº—', 'é¦™æ¸¯å››å­£é…’åº—', 'å¸äº¬é…’åº—', 'å¦‚å¿ƒæµ·æ™¯é…’åº—', 'é¦™æ¸¯æ–‡è¯æ±æ–¹é…’åº—', 'æ¸¯å³¶é¦™æ ¼é‡Œæ‹‰å¤§é…’åº—', 'é¦™æ¸¯Wé…’åº—', 'ä¹é¾é¦™æ ¼é‡Œæ‹‰å¤§é…’åº—', 'é¦™æ¸¯å–œä¾†ç™»é…’åº—']
            },
            'æ±äº¬': {
                attractions: ['æ±äº¬æ™´ç©ºå¡”', 'æ±äº¬è¿ªå£«å°¼æ¨‚åœ’', 'æ·ºè‰å¯ºé›·é–€', 'æ˜æ²»ç¥å®®', 'æ¾€è°·åå­—è·¯å£', 'æ±äº¬éµå¡”', 'ä¸Šé‡å…¬åœ’', 'æ–°å®¿å¾¡è‹‘', 'å°å ´æµ·æ¿±å…¬åœ’', 'ä¸‰é·¹ä¹‹æ£®å‰åœåŠ›ç¾è¡“é¤¨'],
                shopping: ['éŠ€åº§ä¸‰è¶Š', 'æ–°å®¿ä¼Šå‹¢ä¸¹', 'æ¾€è°·109', 'åŸç«¹ä¸‹é€š', 'ç§‹è‘‰åŸé›»å™¨è¡—', 'è¡¨åƒé“ä¹‹ä¸˜', 'å…­æœ¬æœ¨æ–°åŸ', 'æ± è¢‹å¤ªé™½åŸ', 'æ±äº¬è»Šç«™ä¸€ç•ªè¡—', 'é˜¿ç¾æ©«ç”º'],
                food: ['å£½å¸å¤§ç¯‰åœ°å¸‚å ´', 'ä¸€è˜­æ‹‰éºµ', 'èŸ¹é“æ¨‚', 'ç£¯ä¸¸æ°´ç”¢', 'æ•˜æ•˜è‹‘ç‡’è‚‰', 'Afurié˜¿å¤«åˆ©æ‹‰éºµ', 'åˆ©ä¹…ç‰›èˆŒ', 'ç„å“æ²³è±š', 'äº”ä»£ç›® é‡ç”°å²© é°»é­šé£¯', 'Harbsæ°´æœåƒå±¤è›‹ç³•'],
                accommodation: ['æ±äº¬å¸åœ‹é…’åº—', 'æ±äº¬åŠå³¶é…’åº—', 'æ±äº¬æŸæ‚…é…’åº—', 'æ–°å®¿è¯ç››é “é…’åº—', 'APAé…’åº—', 'æ±äº¬ç‹å­å¤§é£¯åº—', 'æ±äº¬ç«™é…’åº—', 'æ±äº¬æ¤¿å±±èŠé…’åº—', 'ä¸‰äº•èŠ±åœ’é£¯åº—', 'æ±äº¬çš‡å®¶ç‹å­å¤§é£¯åº—']
            },
            'å°åŒ—': {
                attractions: ['å°åŒ—101è§€æ™¯å°', 'åœ‹ç«‹æ•…å®®åšç‰©é™¢', 'ä¸­æ­£ç´€å¿µå ‚', 'è¥¿é–€ç”º', 'å£«æ—å¤œå¸‚', 'é¾å±±å¯º', 'é™½æ˜å±±åœ‹å®¶å…¬åœ’', 'è²“ç©ºçºœè»Š', 'è¯å±±1914æ–‡å‰µåœ’å€', 'åŒ—æŠ•æº«æ³‰åšç‰©é¤¨'],
                shopping: ['ä¿¡ç¾©æ–°å…‰ä¸‰è¶Š', 'æ±å€SOGO', 'è¥¿é–€ç”ºå¾’æ­¥å€', 'å°åŒ—è»Šç«™åœ°ä¸‹è¡—', 'ç¾éº—è¯ç™¾æ¨‚åœ’', 'å¾®é¢¨å»£å ´', 'èª å“ä¿¡ç¾©åº—', 'äº¬ç«™æ™‚å°šå»£å ´', 'ATT 4 FUN', 'çµ±ä¸€æ™‚ä»£ç™¾è²¨'],
                food: ['é¼æ³°è±å°ç± åŒ…', 'æ°¸åº·ç‰›è‚‰éºµ', 'é˜¿å®—éºµç·š', 'æ—æ±èŠ³ç‰›è‚‰éºµ', 'é¬é¬šå¼µé­¯è‚‰é£¯', 'é˜œæ­è±†æ¼¿', 'ä½³å¾·é³³æ¢¨é…¥', 'å¯§å¤å¤œå¸‚', 'é¥’æ²³è¡—å¤œå¸‚', 'è€å¤©ç¥¿æ»·å‘³'],
                accommodation: ['å°åŒ—å›æ‚…é…’åº—', 'Wé…’åº—å°åŒ—', 'æ™¶è¯é…’åº—', 'èª å“è¡Œæ—…', 'å¾·ç«‹èŠé…’åº—', 'å°åŒ—å¯’èˆè‰¾ç¾é…’åº—', 'å°åŒ—é æ±é¦™æ ¼é‡Œæ‹‰', 'å°åŒ—èŠ±åœ’å¤§é…’åº—', 'å°åŒ—å‡±æ’’å¤§é£¯åº—', 'å°åŒ—ä¸­å±±é›…æ¨‚è»’é…’åº—']
            }
        };
        
        // ç¤¾äº¤å¹³å°é…ç½®
        const socialPlatforms = [
            { 
                name: 'æŠ–éŸ³', 
                icon: 'fab fa-tiktok', 
                colorClass: 'douyin-color',
                url: (keyword) => `https://www.douyin.com/search/${encodeURIComponent(keyword)}?type=video`,
                description: 'æŸ¥çœ‹æŠ–éŸ³ä¸Šçš„ç†±é–€çŸ­è¦–é »'
            },
            { 
                name: 'å°ç´…æ›¸', 
                icon: 'fas fa-book', 
                colorClass: 'xiaohongshu-color',
                url: (keyword) => `https://www.xiaohongshu.com/search_result?keyword=${encodeURIComponent(keyword)}`,
                description: 'ç€è¦½å°ç´…æ›¸éŠè¨˜èˆ‡æ”»ç•¥'
            },
            { 
                name: 'Bili Bili', 
                icon: 'fas fa-play-circle', 
                colorClass: 'bilibili-color',
                url: (keyword) => `https://search.bilibili.com/all?keyword=${encodeURIComponent(keyword)}`,
                description: 'æŸ¥çœ‹Bç«™æ—…éŠç›¸é—œå½±ç‰‡'
            },
            { 
                name: 'Facebook', 
                icon: 'fab fa-facebook-f', 
                colorClass: 'facebook-color',
                url: (keyword) => `https://www.facebook.com/search/top/?q=${encodeURIComponent(keyword)}`,
                description: 'æœå°‹Facebookç›¸é—œå…§å®¹'
            },
            { 
                name: 'Threads', 
                icon: 'fas fa-comment', 
                colorClass: 'threads-color',
                url: (keyword) => `https://www.threads.net/search?q=${encodeURIComponent(keyword)}`,
                description: 'æŸ¥çœ‹Threadsç›¸é—œè¨è«–'
            },
            { 
                name: 'YouTube', 
                icon: 'fab fa-youtube', 
                colorClass: 'youtube-color',
                url: (keyword) => `https://www.youtube.com/results?search_query=${encodeURIComponent(keyword)}+æ—…éŠ`,
                description: 'è§€çœ‹YouTubeæ—…éŠå½±ç‰‡'
            },
            { 
                name: 'Instagram', 
                icon: 'fab fa-instagram', 
                colorClass: 'instagram-color',
                url: (keyword) => `https://www.instagram.com/explore/tags/${encodeURIComponent(keyword)}/`,
                description: 'ç€è¦½Instagramæ‰“å¡ç…§ç‰‡'
            },
            { 
                name: 'Twitter', 
                icon: 'fab fa-twitter', 
                colorClass: 'twitter-color',
                url: (keyword) => `https://twitter.com/search?q=${encodeURIComponent(keyword)}&src=typed_query`,
                description: 'æŸ¥çœ‹Twitteræœ€æ–°å‹•æ…‹'
            }
        ];
        
        // ç²å–ç”¨æˆ¶ä½ç½®
        function getUserLocation() {
            return new Promise((resolve, reject) => {
                if (navigator.geolocation) {
                    navigator.geolocation.getCurrentPosition(
                        (position) => {
                            userPosition = {
                                lat: position.coords.latitude.toFixed(6),
                                lng: position.coords.longitude.toFixed(6)
                            };
                            const status = document.getElementById('location-status');
                            status.innerHTML = `<i class="fas fa-check-circle"></i> ä½ç½®å·²ç²å–ï¼šç·¯åº¦ ${userPosition.lat}, ç¶“åº¦ ${userPosition.lng}`;
                            status.className = 'location-status success';
                            resolve(userPosition);
                        },
                        (error) => {
                            const status = document.getElementById('location-status');
                            let message = `ç²å–ä½ç½®è¶…æ™‚ï¼Œä½¿ç”¨é»˜èªä½ç½®ï¼š${DEFAULT_LOCATION_NAME}ã€‚`;
                            switch(error.code) {
                                case error.PERMISSION_DENIED:
                                    message = `ä½ç½®æœå‹™è¢«æ‹’çµ•ï¼Œä½¿ç”¨é»˜èªä½ç½®ï¼š${DEFAULT_LOCATION_NAME}ã€‚`;
                                    break;
                                case error.POSITION_UNAVAILABLE:
                                    message = `ä½ç½®ä¿¡æ¯ä¸å¯ç”¨ï¼Œä½¿ç”¨é»˜èªä½ç½®ï¼š${DEFAULT_LOCATION_NAME}ã€‚`;
                                    break;
                                case error.TIMEOUT:
                                    message = `ç²å–ä½ç½®è¶…æ™‚ï¼Œä½¿ç”¨é»˜èªä½ç½®ï¼š${DEFAULT_LOCATION_NAME}ã€‚`;
                                    break;
                            }
                            userPosition = DEFAULT_POSITION;
                            status.innerHTML = `<i class="fas fa-map-marker-alt"></i> ${message}`;
                            status.className = 'location-status warning';
                            resolve(userPosition);
                        },
                        { timeout: 5000, enableHighAccuracy: true } // è¨­ç½®5ç§’è¶…æ™‚
                    );
                } else {
                    userPosition = DEFAULT_POSITION;
                    document.getElementById('location-status').innerHTML = 
                        `<i class="fas fa-map-marker-alt"></i> ç€è¦½å™¨ä¸æ”¯æŒä½ç½®æœå‹™ï¼Œä½¿ç”¨é»˜èªä½ç½®ï¼š${DEFAULT_LOCATION_NAME}ã€‚`;
                    document.getElementById('location-status').className = 'location-status warning';
                    resolve(userPosition);
                }
            });
        }
        
        function setDestination(dest) {
            document.getElementById('destination').value = dest;
            planTrip();
        }
        
        function handleKeyPress(event) {
            if (event.key === 'Enter') planTrip();
        }
        
        // ç”Ÿæˆæœ¬åœ°æ¨è–¦å…§å®¹ï¼ˆç„¡éœ€APIï¼‰
        function generateLocalRecommendations(destination) {
            let recommendations = {
                attractions: [],
                shopping: [],
                food: [],
                accommodation: []
            };
            
            // æª¢æŸ¥æ˜¯å¦åŒ¹é…å·²çŸ¥çš„ç†±é–€ç›®çš„åœ°
            for (const city in popularDestinations) {
                if (destination.includes(city)) {
                    recommendations = JSON.parse(JSON.stringify(popularDestinations[city]));
                    break;
                }
            }
            
            // å¦‚æœæ²’æœ‰åŒ¹é…çš„é è¨­æ•¸æ“šï¼Œå‰‡ç”Ÿæˆé€šç”¨æ¨è–¦
            if (recommendations.attractions.length === 0) {
                recommendations = {
                    attractions: [
                        `${destination}ä¸»è¦æ™¯é»`,
                        `${destination}æ­·å²å¤è¹Ÿ`,
                        `${destination}è‡ªç„¶é¢¨å…‰`,
                        `${destination}æ–‡åŒ–é«”é©—`,
                        `${destination}è§€æ™¯å°`,
                        `${destination}åšç‰©é¤¨`,
                        `${destination}ä¸»é¡Œæ¨‚åœ’`,
                        `${destination}è€è¡—å€`,
                        `${destination}å®—æ•™å ´æ‰€`,
                        `${destination}å…¬åœ’å»£å ´`
                    ],
                    shopping: [
                        `${destination}è³¼ç‰©ä¸­å¿ƒ`,
                        `${destination}å‚³çµ±å¸‚å ´`,
                        `${destination}ç‰¹è‰²å•†åº—`,
                        `${destination}å…ç¨…åº—`,
                        `${destination}ç´€å¿µå“åº—`,
                        `${destination}ç™¾è²¨å…¬å¸`,
                        `${destination}å¤œå¸‚`,
                        `${destination}Outlet`,
                        `${destination}ç²¾å“åº—`,
                        `${destination}æ‰‹å·¥è—å“åº—`
                    ],
                    food: [
                        `${destination}ç‰¹è‰²é¤å»³`,
                        `${destination}åœ°é“å°åƒ`,
                        `${destination}å’–å•¡å»³`,
                        `${destination}å¤œå¸‚ç¾é£Ÿ`,
                        `${destination}æµ·é®®é¤å»³`,
                        `${destination}ç±³å…¶æ—é¤å»³`,
                        `${destination}ç´ é£Ÿé¤å»³`,
                        `${destination}æ—©é¤åº—`,
                        `${destination}ç”œå“åº—`,
                        `${destination}é…’å§`
                    ],
                    accommodation: [
                        `${destination}äº”æ˜Ÿé…’åº—`,
                        `${destination}ç²¾å“æ—…é¤¨`,
                        `${destination}æ°‘å®¿`,
                        `${destination}å•†å‹™é…’åº—`,
                        `${destination}é’å¹´æ—…èˆ`,
                        `${destination}åº¦å‡æ‘`,
                        `${destination}æœå‹™å¼å…¬å¯“`,
                        `${destination}æº«æ³‰æ—…é¤¨`,
                        `${destination}è¨­è¨ˆé…’åº—`,
                        `${destination}æµ·æ™¯é…’åº—`
                    ]
                };
            }
            
            return recommendations;
        }
        
        // å‰µå»ºæ¨è–¦é …ç›®HTML
        function createRecommendationHTML(items, category, destination) {
            return items.map(item => `
                <div class="recommendation-item">
                    <span>${item}</span>
                    <a href="https://www.google.com/search?q=${encodeURIComponent(item)}" target="_blank" rel="noopener noreferrer">
                        æœå°‹
                    </a>
                </div>
            `).join('');
        }
        
        // å‰µå»ºç¤¾äº¤å¹³å°HTML
        function createSocialPlatformsHTML(destination) {
            return socialPlatforms.map(platform => `
                <div class="social-item">
                    <div class="social-name">
                        <div class="social-icon">
                            <i class="${platform.icon}"></i>
                        </div>
                        <div>
                            <strong>${platform.name}</strong>
                            <div style="font-size: 0.8em; color: #666;">${platform.description}</div>
                        </div>
                    </div>
                    <a href="${platform.url(destination)}" target="_blank" rel="noopener noreferrer" class="${platform.colorClass}" style="color: white;">
                        æŸ¥çœ‹
                    </a>
                </div>
            `).join('');
        }
        
        // è¦åŠƒè¡Œç¨‹ä¸»å‡½æ•¸
        async function planTrip() {
            const destination = document.getElementById('destination').value.trim();
            const planBtn = document.getElementById('plan-btn');
            
            if (!destination) {
                alert('è«‹è¼¸å…¥ç›®çš„åœ°ï¼');
                return;
            }
            
            // ç¦ç”¨æŒ‰éˆ•é˜²æ­¢é‡è¤‡é»æ“Š
            planBtn.disabled = true;
            planBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> è¦åŠƒä¸­...';
            
            try {
                const resultsDiv = document.getElementById('results');
                resultsDiv.innerHTML = '<div class="loading">æ­£åœ¨è¦åŠƒæ‚¨çš„è¡Œç¨‹...</div>';
                
                // ç¢ºä¿æœ‰ä½ç½®ä¿¡æ¯
                if (!userPosition) {
                    await getUserLocation();
                }
                
                const origin = `${userPosition.lat},${userPosition.lng}`;
                const encodedDestination = encodeURIComponent(destination);
                
                // ç”Ÿæˆè·¯ç·šè¦åŠƒé€£çµ
                const links = {
                    routes: {
                        transit: `https://www.google.com/maps/dir/?api=1&origin=${origin}&destination=${encodedDestination}&travelmode=transit&dir_action=navigate`,
                        walking: `https://www.google.com/maps/dir/?api=1&origin=${origin}&destination=${encodedDestination}&travelmode=walking&dir_action=navigate`,
                        driving: `https://www.google.com/maps/dir/?api=1&origin=${origin}&destination=${encodedDestination}&travelmode=driving&dir_action=navigate`
                    },
                    booking: {
                        hotels: `https://www.booking.com/searchresults.html?ss=${encodedDestination}`,
                        flights: `https://www.skyscanner.com.hk/transport/flights/${encodedDestination}`,
                        activities: `https://www.klook.com/zh-HK/search/?query=${encodedDestination}`
                    }
                };
                
                // ç”Ÿæˆæœ¬åœ°æ¨è–¦
                const localRecommendations = generateLocalRecommendations(destination);
                
                // é¡¯ç¤ºçµæœ
                resultsDiv.innerHTML = '';
                
                // è·¯ç·šè¦åŠƒéƒ¨åˆ†
                const routesSection = document.createElement('div');
                routesSection.className = 'section section-routes';
                const startLocation = userPosition === DEFAULT_POSITION ? DEFAULT_LOCATION_NAME : "æ‚¨çš„ä½ç½®";
                routesSection.innerHTML = `
                    <h2><i class="fas fa-route"></i> è·¯ç·šè¦åŠƒ</h2>
                    <p>å¾ <strong>${startLocation}</strong> å‰å¾€ <strong>${destination}</strong> çš„è·¯ç·šï¼š</p>
                    <div class="recommendations-grid">
                        <div class="recommendation-item">
                            <span><i class="fas fa-bus"></i> å…¬å…±äº¤é€šè·¯ç·š</span>
                            <a href="${links.routes.transit}" target="_blank" rel="noopener noreferrer">æŸ¥çœ‹è·¯ç·š</a>
                        </div>
                        <div class="recommendation-item">
                            <span><i class="fas fa-walking"></i> æ­¥è¡Œè·¯ç·š</span>
                            <a href="${links.routes.walking}" target="_blank" rel="noopener noreferrer">æŸ¥çœ‹è·¯ç·š</a>
                        </div>
                        <div class="recommendation-item">
                            <span><i class="fas fa-car"></i> è‡ªé§•è·¯ç·š</span>
                            <a href="${links.routes.driving}" target="_blank" rel="noopener noreferrer">æŸ¥çœ‹è·¯ç·š</a>
                        </div>
                    </div>
                `;
                resultsDiv.appendChild(routesSection);
                
                // æœ¬åœ°æ¨è–¦éƒ¨åˆ†
                const recommendationsSection = document.createElement('div');
                recommendationsSection.className = 'section section-rankings';
                recommendationsSection.innerHTML = `
                    <h2><i class="fas fa-star"></i> æœ¬åœ°æ¨è–¦</h2>
                    <p>ç‚ºæ‚¨æ¨è–¦ <strong>${destination}</strong> çš„ç†±é–€åœ°é»ï¼š</p>
                    
                    <h3><span class="category-tag tag-attractions">æ™¯é»</span> æ¨è–¦æ™¯é»</h3>
                    <div class="recommendations-grid">
                        ${createRecommendationHTML(localRecommendations.attractions, 'attractions', destination)}
                    </div>
                    
                    <h3><span class="category-tag tag-shopping">è³¼ç‰©</span> æ¨è–¦è³¼ç‰©åœ°é»</h3>
                    <div class="recommendations-grid">
                        ${createRecommendationHTML(localRecommendations.shopping, 'shopping', destination)}
                    </div>
                    
                    <h3><span class="category-tag tag-food">ç¾é£Ÿ</span> æ¨è–¦é¤å»³èˆ‡ç¾é£Ÿ</h3>
                    <div class="recommendations-grid">
                        ${createRecommendationHTML(localRecommendations.food, 'food', destination)}
                    </div>
                    
                    <h3><span class="category-tag tag-accommodation">ä½å®¿</span> æ¨è–¦ä½å®¿</h3>
                    <div class="recommendations-grid">
                        ${createRecommendationHTML(localRecommendations.accommodation, 'accommodation', destination)}
                    </div>
                `;
                resultsDiv.appendChild(recommendationsSection);
                
                // ç¤¾ç¾¤ç†±é»éƒ¨åˆ†
                const socialSection = document.createElement('div');
                socialSection.className = 'section section-social';
                socialSection.innerHTML = `
                    <h2><i class="fas fa-hashtag"></i> ç¤¾ç¾¤ç†±é»</h2>
                    <p>æŸ¥çœ‹ç¤¾äº¤åª’é«”ä¸Šé—œæ–¼ <strong>${destination}</strong> çš„ç†±é–€å…§å®¹ï¼š</p>
                    <div class="social-grid">
                        ${createSocialPlatformsHTML(destination)}
                    </div>
                `;
                resultsDiv.appendChild(socialSection);
                
                // é è¨‚èˆ‡æ›´å¤šè³‡è¨Šéƒ¨åˆ†
                const bookingSection = document.createElement('div');
                bookingSection.className = 'section section-booking';
                bookingSection.innerHTML = `
                    <h2><i class="fas fa-hotel"></i> é è¨‚èˆ‡æ›´å¤šè³‡è¨Š</h2>
                    <p>ç‚ºæ‚¨çš„ <strong>${destination}</strong> ä¹‹æ—…åšå¥½æº–å‚™ï¼š</p>
                    <div class="recommendations-grid">
                        <div class="recommendation-item">
                            <span><i class="fas fa-bed"></i> é è¨‚é…’åº—</span>
                            <a href="${links.booking.hotels}" target="_blank" rel="noopener noreferrer">æŸ¥çœ‹é¸é …</a>
                        </div>
                        <div class="recommendation-item">
                            <span><i class="fas fa-plane"></i> æŸ¥è©¢èˆªç­</span>
                            <a href="${links.booking.flights}" target="_blank" rel="noopener noreferrer">æœå°‹èˆªç­</a>
                        </div>
                        <div class="recommendation-item">
                            <span><i class="fas fa-ticket-alt"></i> é è¨‚æ´»å‹•èˆ‡é–€ç¥¨</span>
                            <a href="${links.booking.activities}" target="_blank" rel="noopener noreferrer">æŸ¥çœ‹æ´»å‹•</a>
                        </div>
                        <div class="recommendation-item">
                            <span><i class="fas fa-utensils"></i> é¤å»³é è¨‚</span>
                            <a href="https://www.google.com/search?q=${encodedDestination}+é¤å»³é è¨‚" target="_blank" rel="noopener noreferrer">æœå°‹é¤å»³</a>
                        </div>
                    </div>
                    <div style="margin-top: 20px; padding: 15px; background: #f8f9fa; border-radius: 8px;">
                        <p><strong><i class="fas fa-lightbulb"></i> å°è²¼å£«ï¼š</strong> æ‰€æœ‰é€£çµå°‡åœ¨æ–°æ¨™ç±¤é æ‰“é–‹ï¼Œæ–¹ä¾¿æ‚¨æ¯”è¼ƒå’Œè¦åŠƒã€‚</p>
                        <p><strong><i class="fas fa-map-marker-alt"></i> å‡ºç™¼åœ°ï¼š</strong> ${startLocation} (ç·¯åº¦: ${userPosition.lat}, ç¶“åº¦: ${userPosition.lng})</p>
                    </div>
                `;
                resultsDiv.appendChild(bookingSection);
                
                // æ»¾å‹•åˆ°çµæœå€åŸŸ
                resultsDiv.scrollIntoView({ behavior: 'smooth' });
                
            } catch (error) {
                console.error('è¡Œç¨‹è¦åŠƒéŒ¯èª¤:', error);
                document.getElementById('results').innerHTML = `
                    <div class="location-status error">
                        <i class="fas fa-exclamation-circle"></i> <strong>ç™¼ç”ŸéŒ¯èª¤ï¼š</strong> ${error.message}<br>
                        è«‹æª¢æŸ¥ç¶²çµ¡é€£æ¥å¾Œé‡è©¦ã€‚
                    </div>
                `;
            } finally {
                // é‡æ–°å•Ÿç”¨æŒ‰éˆ•
                planBtn.disabled = false;
                planBtn.innerHTML = '<i class="fas fa-search"></i> è¦åŠƒè¡Œç¨‹';
            }
        }
        
        // é é¢è¼‰å…¥æ™‚ç²å–ä½ç½®
        window.addEventListener('DOMContentLoaded', async () => {
            try {
                await getUserLocation();
            } catch (error) {
                console.error('åˆå§‹åŒ–éŒ¯èª¤:', error);
            }
        });
    </script>
</body>
</html>