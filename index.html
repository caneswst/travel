<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>æ™ºèƒ½æ—…æ¸¸è¡Œç¨‹è§„åˆ’</title>
    <style>
        * {
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        body {
            font-family: 'PingFang SC', 'Microsoft YaHei', sans-serif;
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            color: #333;
            min-height: 100vh;
            font-size: 16px;
        }
        .container {
            background: white;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            margin-bottom: 20px;
            position: relative;
            max-width: 100%;
            overflow-x: hidden;
        }
        .version-switcher {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
            justify-content: center;
        }
        .version-btn {
            padding: 12px 20px;
            background: #f1f2f6;
            border: 1px solid #ddd;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 16px;
            flex: 1;
            min-width: 140px;
            text-align: center;
            font-weight: 500;
        }
        .version-btn:hover {
            background: #3498db;
            color: white;
            border-color: #3498db;
        }
        .version-btn.active {
            background: #3498db;
            color: white;
            border-color: #3498db;
            box-shadow: 0 4px 8px rgba(52, 152, 219, 0.3);
        }
        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 10px;
            font-size: 24px;
            padding: 0 10px;
        }
        .subtitle {
            text-align: center;
            color: #7f8c8d;
            margin-bottom: 25px;
            font-size: 14px;
            padding: 0 10px;
            line-height: 1.4;
        }
        .input-section {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-direction: column;
        }
        .location-section {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 20px;
        }
        .location-selector {
            padding: 15px;
            background: #f8f9fa;
            border-radius: 12px;
            border: 2px solid #e9ecef;
        }
        .location-selector h3 {
            margin-top: 0;
            margin-bottom: 12px;
            color: #2c3e50;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 18px;
        }
        select, input, button {
            padding: 16px;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s;
            width: 100%;
        }
        select {
            background-color: #f8f9fa;
            cursor: pointer;
        }
        input {
            background-color: #f8f9fa;
        }
        select:focus, input:focus {
            outline: none;
            border-color: #3498db;
            background-color: white;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
        }
        .main-btn {
            background: linear-gradient(to right, #3498db, #2980b9);
            color: white;
            border: none;
            cursor: pointer;
            font-weight: bold;
            padding: 16px;
            border-radius: 10px;
            font-size: 18px;
            margin-top: 10px;
        }
        .main-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 7px 14px rgba(52, 152, 219, 0.3);
        }
        .main-btn:active {
            transform: translateY(0);
        }
        .location-status {
            padding: 15px;
            margin: 15px 0;
            border-radius: 10px;
            font-size: 14px;
        }
        .success { background: #d4edda; color: #155724; border-left: 4px solid #28a745; }
        .warning { background: #fff3cd; color: #856404; border-left: 4px solid #ffc107; }
        .error { background: #f8d7da; color: #721c24; border-left: 4px solid #dc3545; }
        .info { background: #d1ecf1; color: #0c5460; border-left: 4px solid #17a2b8; }
        .results-container {
            margin-top: 30px;
        }
        .section {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            border-top: 5px solid;
            transition: transform 0.3s;
        }
        .section:hover {
            transform: translateY(-3px);
        }
        .section-routes { border-top-color: #3498db; }
        .section-rankings { border-top-color: #e74c3c; }
        .section-social { border-top-color: #9b59b6; }
        .section-tools { border-top-color: #2ecc71; }
        h2 {
            color: #2c3e50;
            margin-top: 0;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 20px;
        }
        h2 i {
            font-size: 1.3em;
        }
        .social-grid {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-top: 15px;
        }
        .social-item {
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
            transition: all 0.3s;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .social-item:hover {
            background: #e9ecef;
            transform: translateX(3px);
        }
        .social-icon {
            font-size: 1.3em;
            margin-right: 10px;
            width: 30px;
            text-align: center;
        }
        .social-name {
            flex-grow: 1;
            display: flex;
            align-items: center;
        }
        a {
            color: #3498db;
            text-decoration: none;
            font-weight: 500;
            padding: 8px 12px;
            border-radius: 6px;
            transition: all 0.2s;
            white-space: nowrap;
            display: inline-block;
        }
        a:hover {
            background: #3498db;
            color: white;
            text-decoration: none;
        }
        .category-tag {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            margin-right: 8px;
        }
        .tag-attractions { background: #ffebee; color: #c62828; }
        .tag-shopping { background: #fff3e0; color: #ef6c00; }
        .tag-food { background: #e8f5e9; color: #2e7d32; }
        .tag-accommodation { background: #e3f2fd; color: #1565c0; }
        .recommendations-grid {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-top: 15px;
            margin-bottom: 20px;
        }
        .recommendation-item {
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
            transition: all 0.3s;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .recommendation-item:hover {
            background: #e9ecef;
            transform: translateX(3px);
        }
        .loading {
            text-align: center;
            padding: 30px;
            color: #7f8c8d;
            font-size: 16px;
        }
        .loading:after {
            content: '...';
            animation: dots 1.5s steps(4, end) infinite;
        }
        @keyframes dots {
            0%, 20% { content: '.'; }
            40% { content: '..'; }
            60%, 100% { content: '...'; }
        }
        .no-api-note {
            background: #e8f4fc;
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            line-height: 1.5;
            border-left: 4px solid #3498db;
            font-size: 14px;
        }
        .popular-destinations {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 15px;
            margin-bottom: 25px;
        }
        .popular-btn {
            padding: 10px 15px;
            background: #f1f2f6;
            border: 1px solid #ddd;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 14px;
            flex-grow: 1;
            min-width: calc(50% - 10px);
        }
        .popular-btn:hover {
            background: #3498db;
            color: white;
            border-color: #3498db;
        }
        .feature-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin: 25px 0;
        }
        .feature {
            padding: 15px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
            text-align: center;
        }
        .feature-icon {
            font-size: 2em;
            margin-bottom: 8px;
        }
        .feature h3 {
            margin-top: 0;
            color: #2c3e50;
            font-size: 16px;
        }
        .feature p {
            font-size: 13px;
            color: #666;
        }
        .social-colors {
            color: #fff;
            padding: 5px 10px;
            border-radius: 6px;
            font-size: 13px;
        }
        .douyin-color { background: linear-gradient(to right, #FE2C55, #25F4EE); }
        .xiaohongshu-color { background: #FF2442; }
        .bilibili-color { background: #FB7299; }
        .weibo-color { background: #E6162D; }
        .zhihu-color { background: #0084FF; }
        .dianping-color { background: #FF4E3C; }
        .ctrip-color { background: #FF6600; }
        .facebook-color { background: #1877F2; }
        .instagram-color { background: linear-gradient(45deg, #405DE6, #5851DB, #833AB4, #C13584, #E1306C, #FD1D1D); }
        .twitter-color { background: #1DA1F2; }
        .youtube-color { background: #FF0000; }
        .google-color { background: #4285F4; }
        .tripadvisor-color { background: #00aa87; }
        .route-options {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 15px;
        }
        .route-btn {
            padding: 14px;
            background: #f1f2f6;
            border: 1px solid #ddd;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 16px;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        .route-btn:hover {
            background: #3498db;
            color: white;
            border-color: #3498db;
        }
        .route-btn.active {
            background: #3498db;
            color: white;
            border-color: #3498db;
        }
        .location-buttons {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }
        .location-btn {
            padding: 12px 15px;
            background: #f1f2f6;
            border: 1px solid #ddd;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 14px;
            flex: 1;
            text-align: center;
        }
        .location-btn:hover {
            background: #3498db;
            color: white;
            border-color: #3498db;
        }
        .location-btn.active {
            background: #3498db;
            color: white;
            border-color: #3498db;
        }
        .location-options {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        .location-option {
            display: flex;
            align-items: center;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
        }
        .location-option:hover {
            background: #f0f8ff;
        }
        .location-option.active {
            background: #e1f0ff;
            border-color: #3498db;
        }
        .location-option input {
            margin-right: 10px;
            width: auto;
        }
        .location-option label {
            cursor: pointer;
            flex-grow: 1;
            font-size: 15px;
        }
        .language-switcher {
            display: flex;
            gap: 5px;
            margin-bottom: 15px;
            justify-content: center;
        }
        .lang-btn {
            padding: 8px 15px;
            background: #f1f2f6;
            border: 1px solid #ddd;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 14px;
        }
        .lang-btn:hover {
            background: #3498db;
            color: white;
            border-color: #3498db;
        }
        .lang-btn.active {
            background: #3498db;
            color: white;
            border-color: #3498db;
        }
        .map-buttons {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }
        .map-app-btn {
            padding: 14px;
            border-radius: 10px;
            font-size: 16px;
            flex: 1;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            font-weight: 500;
            border: none;
            cursor: pointer;
        }
        .baidu-map-btn {
            background: #3385ff;
            color: white;
        }
        .gaode-map-btn {
            background: #0089ff;
            color: white;
        }
        .google-map-btn {
            background: #4285f4;
            color: white;
        }
        .mode-selector {
            display: flex;
            gap: 8px;
            margin-top: 15px;
            flex-wrap: wrap;
        }
        .mode-btn {
            padding: 10px 15px;
            background: #f8f9fa;
            border: 1px solid #ddd;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 14px;
            flex: 1;
            text-align: center;
            min-width: 80px;
        }
        .mode-btn:hover {
            background: #3498db;
            color: white;
            border-color: #3498db;
        }
        .mode-btn.active {
            background: #3498db;
            color: white;
            border-color: #3498db;
        }
        @media (min-width: 768px) {
            .container {
                max-width: 768px;
                margin: 20px auto;
                padding: 30px;
                border-radius: 20px;
            }
            .input-section {
                flex-direction: row;
            }
            .feature-list {
                flex-direction: row;
                flex-wrap: wrap;
            }
            .feature {
                flex: 1;
                min-width: calc(50% - 15px);
            }
            .location-section {
                flex-direction: row;
            }
            .location-selector {
                flex: 1;
            }
            .social-grid, .recommendations-grid {
                display: grid;
                grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            }
            .route-options, .map-buttons {
                flex-direction: row;
            }
            .popular-btn {
                min-width: auto;
                flex-grow: 0;
            }
        }
        @media (max-width: 480px) {
            h1 {
                font-size: 22px;
            }
            .subtitle {
                font-size: 13px;
            }
            .version-btn {
                min-width: 130px;
                padding: 10px 15px;
            }
            .popular-btn {
                min-width: calc(100% - 10px);
            }
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="container">
        <div class="version-switcher">
            <button class="version-btn active" id="cn-version-btn" onclick="switchVersion('cn')">ä¸­å›½ç‰ˆ</button>
            <button class="version-btn" id="intl-version-btn" onclick="switchVersion('intl')">å›½é™…ç‰ˆ</button>
        </div>
        
        <div class="language-switcher" id="language-switcher">
            <button class="lang-btn active" onclick="switchLanguage('zh-CN')">ç®€ä½“</button>
            <button class="lang-btn" onclick="switchLanguage('zh-TW')">ç¹é«”</button>
        </div>
        
        <h1 id="main-title"><i class="fas fa-plane-departure"></i> æ™ºèƒ½æ—…æ¸¸è¡Œç¨‹è§„åˆ’</h1>
        <div class="subtitle" id="version-subtitle">å®Œå…¨æœ¬åœ°è¿è¡Œ Â· æ— éœ€APIå¯†é’¥ Â· å®æ—¶è·¯çº¿è§„åˆ’ Â· æ”¯æŒå…¨å›½åŸå¸‚</div>
        
        <div class="no-api-note">
            <i class="fas fa-info-circle"></i> <span id="version-note">æœ¬å·¥å…·å®Œå…¨åœ¨æ‚¨çš„æµè§ˆå™¨ä¸­è¿è¡Œï¼Œæ— éœ€ä»»ä½•APIå¯†é’¥ã€‚æ‰€æœ‰æ•°æ®å‡æ¥è‡ªå…¬å¼€ç½‘ç»œèµ„æºã€‚</span>
        </div>
        
        <div class="feature-list">
            <div class="feature">
                <div class="feature-icon">ğŸ“</div>
                <h3 id="feature-location">å‡ºå‘åœ°é€‰æ‹©</h3>
                <p id="feature-location-desc">å¯é€‰æ‹©å¤šä¸ªçƒ­é—¨åŸå¸‚å‡ºå‘</p>
            </div>
            <div class="feature">
                <div class="feature-icon">ğŸ—ºï¸</div>
                <h3 id="feature-routes">è·¯çº¿è§„åˆ’</h3>
                <p id="feature-routes-desc">æä¾›ç™¾åº¦/é«˜å¾·åœ°å›¾è·¯çº¿</p>
            </div>
            <div class="feature">
                <div class="feature-icon">ğŸ†</div>
                <h3 id="feature-recommend">çƒ­é—¨æ¨è</h3>
                <p id="feature-recommend-desc">æ¨èå½“åœ°çƒ­é—¨æ™¯ç‚¹ä¸æ´»åŠ¨</p>
            </div>
            <div class="feature">
                <div class="feature-icon">ğŸ“±</div>
                <h3 id="feature-social">ç¤¾äº¤çƒ­ç‚¹</h3>
                <p id="feature-social-desc">æŸ¥çœ‹ç¤¾äº¤åª’ä½“ä¸Šçš„çƒ­é—¨å†…å®¹</p>
            </div>
        </div>
        
        <!-- å‡ºå‘åœ°ç‚¹é€‰æ‹©éƒ¨åˆ† -->
        <div class="location-section">
            <div class="location-selector">
                <h3><i class="fas fa-map-marker-alt"></i> <span id="location-select-title">é€‰æ‹©å‡ºå‘åœ°</span></h3>
                <p id="location-select-desc">è¯·é€‰æ‹©æ‚¨çš„å‡ºå‘åœ°ç‚¹ï¼š</p>
                <div class="location-options">
                    <div class="location-option" id="current-location-option">
                        <input type="radio" id="location-current" name="location-type" checked>
                        <label for="location-current" id="location-current-label">ä½¿ç”¨æˆ‘çš„å½“å‰ä½ç½®</label>
                    </div>
                    <div class="location-option" id="select-location-option">
                        <input type="radio" id="location-select" name="location-type">
                        <label for="location-select" id="location-select-label">ä»çƒ­é—¨åŸå¸‚é€‰æ‹©</label>
                    </div>
                </div>
                
                <div id="custom-location-selector" style="display: none; margin-top: 15px;">
                    <label for="city-locations" id="city-locations-label">é€‰æ‹©å‡ºå‘åŸå¸‚ï¼š</label>
                    <select id="city-locations">
                        <!-- åŸå¸‚é€‰é¡¹ä¼šæ ¹æ®ç‰ˆæœ¬åŠ¨æ€ç”Ÿæˆ -->
                    </select>
                </div>
                
                <div class="location-buttons">
                    <button class="location-btn" id="update-location-btn" onclick="updateLocation()"><i class="fas fa-sync-alt"></i> <span id="update-location-text">æ›´æ–°ä½ç½®</span></button>
                    <button class="location-btn" id="reset-location-btn" onclick="resetToDefaultLocation()"><i class="fas fa-home"></i> <span id="reset-location-text">é‡ç½®</span></button>
                </div>
            </div>
            
            <div class="location-selector">
                <h3><i class="fas fa-location-arrow"></i> <span id="location-status-title">å½“å‰ä½ç½®çŠ¶æ€</span></h3>
                <div id="location-status" class="location-status info">
                    <i class="fas fa-sync fa-spin"></i> <span id="location-status-text">æ­£åœ¨è·å–æ‚¨çš„ä½ç½®...</span>
                </div>
                <div id="location-details">
                    <p><strong id="location-detail-start">å‡ºå‘åœ°ï¼š</strong> <span id="current-location-name">åŒ—äº¬å¸‚ä¸­å¿ƒ</span></p>
                    <p><strong id="location-detail-coords">åæ ‡ï¼š</strong> <span id="current-coordinates">çº¬åº¦ 39.9042, ç»åº¦ 116.4074</span></p>
                </div>
            </div>
        </div>
        
        <!-- ç›®çš„åœ°è¾“å…¥éƒ¨åˆ† -->
        <div class="input-section">
            <input type="text" id="destination" placeholder="è¯·è¾“å…¥ç›®çš„åœ°ï¼ˆä¾‹å¦‚ï¼šåŒ—äº¬æ•…å®«ã€ä¸Šæµ·å¤–æ»©ã€å¹¿å·å¡”ï¼‰" onkeypress="handleKeyPress(event)">
            <button class="main-btn" onclick="planTrip()" id="plan-btn"><i class="fas fa-search"></i> <span id="plan-trip-text">è§„åˆ’è¡Œç¨‹</span></button>
        </div>
        
        <div class="popular-destinations">
            <div id="popular-dest-label">çƒ­é—¨ç›®çš„åœ°ï¼š</div>
            <!-- çƒ­é—¨ç›®çš„åœ°æŒ‰é’®ä¼šæ ¹æ®ç‰ˆæœ¬åŠ¨æ€ç”Ÿæˆ -->
        </div>
        
        <div id="results" class="results-container"></div>
    </div>

    <script>
        // å…¨å±€å˜é‡
        let userPosition = null;
        let currentVersion = 'cn'; // 'cn' æˆ– 'intl'
        let currentLanguage = 'zh-CN'; // 'zh-CN', 'zh-TW'
        
        // è¯­è¨€æ–‡æœ¬é…ç½®
        const languageTexts = {
            'zh-CN': {
                // ä¸­å›½ç‰ˆç®€ä½“ä¸­æ–‡
                title: 'æ™ºèƒ½æ—…æ¸¸è¡Œç¨‹è§„åˆ’',
                subtitle: 'å®Œå…¨æœ¬åœ°è¿è¡Œ Â· æ— éœ€APIå¯†é’¥ Â· å®æ—¶è·¯çº¿è§„åˆ’ Â· æ”¯æŒå…¨å›½åŸå¸‚',
                note: 'æœ¬å·¥å…·å®Œå…¨åœ¨æ‚¨çš„æµè§ˆå™¨ä¸­è¿è¡Œï¼Œæ— éœ€ä»»ä½•APIå¯†é’¥ã€‚æ‰€æœ‰æ•°æ®å‡æ¥è‡ªå…¬å¼€ç½‘ç»œèµ„æºã€‚',
                
                // åŠŸèƒ½æè¿°
                featureLocation: 'å‡ºå‘åœ°é€‰æ‹©',
                featureLocationDesc: 'å¯é€‰æ‹©å¤šä¸ªçƒ­é—¨åŸå¸‚å‡ºå‘',
                featureRoutes: 'è·¯çº¿è§„åˆ’',
                featureRoutesDesc: 'æä¾›ç™¾åº¦/é«˜å¾·åœ°å›¾è·¯çº¿',
                featureRecommend: 'çƒ­é—¨æ¨è',
                featureRecommendDesc: 'æ¨èå½“åœ°çƒ­é—¨æ™¯ç‚¹ä¸æ´»åŠ¨',
                featureSocial: 'ç¤¾äº¤çƒ­ç‚¹',
                featureSocialDesc: 'æŸ¥çœ‹ç¤¾äº¤åª’ä½“ä¸Šçš„çƒ­é—¨å†…å®¹',
                
                // ä½ç½®é€‰æ‹©
                locationSelectTitle: 'é€‰æ‹©å‡ºå‘åœ°',
                locationSelectDesc: 'è¯·é€‰æ‹©æ‚¨çš„å‡ºå‘åœ°ç‚¹ï¼š',
                locationCurrentLabel: 'ä½¿ç”¨æˆ‘çš„å½“å‰ä½ç½®',
                locationSelectLabel: 'ä»çƒ­é—¨åŸå¸‚é€‰æ‹©',
                cityLocationsLabel: 'é€‰æ‹©å‡ºå‘åŸå¸‚ï¼š',
                updateLocationText: 'æ›´æ–°ä½ç½®',
                resetLocationText: 'é‡ç½®',
                
                // ä½ç½®çŠ¶æ€
                locationStatusTitle: 'å½“å‰ä½ç½®çŠ¶æ€',
                locationStatusText: 'æ­£åœ¨è·å–æ‚¨çš„ä½ç½®...',
                locationDetailStart: 'å‡ºå‘åœ°ï¼š',
                locationDetailCoords: 'åæ ‡ï¼š',
                
                // ç›®çš„åœ°è¾“å…¥
                destinationPlaceholder: 'è¯·è¾“å…¥ç›®çš„åœ°ï¼ˆä¾‹å¦‚ï¼šåŒ—äº¬æ•…å®«ã€ä¸Šæµ·å¤–æ»©ã€å¹¿å·å¡”ï¼‰',
                planTripText: 'è§„åˆ’è¡Œç¨‹',
                
                // çƒ­é—¨ç›®çš„åœ°
                popularDestLabel: 'çƒ­é—¨ç›®çš„åœ°ï¼š',
                
                // ç»“æœéƒ¨åˆ†
                loadingText: 'æ­£åœ¨è§„åˆ’æ‚¨çš„è¡Œç¨‹...',
                routesTitle: 'è·¯çº¿è§„åˆ’',
                routesDesc: 'ä» {start} å‰å¾€ {dest} çš„è·¯çº¿ï¼š',
                recommendationsTitle: 'æœ¬åœ°æ¨è',
                recommendationsDesc: 'ä¸ºæ‚¨æ¨è {dest} çš„çƒ­é—¨åœ°ç‚¹ï¼š',
                attractionsTitle: 'æ™¯ç‚¹',
                attractionsDesc: 'æ¨èæ™¯ç‚¹',
                shoppingTitle: 'è´­ç‰©',
                shoppingDesc: 'æ¨èè´­ç‰©åœ°ç‚¹',
                foodTitle: 'ç¾é£Ÿ',
                foodDesc: 'æ¨èé¤å…ä¸ç¾é£Ÿ',
                accommodationTitle: 'ä½å®¿',
                accommodationDesc: 'æ¨èä½å®¿',
                socialTitle: 'ç¤¾äº¤çƒ­ç‚¹',
                socialDesc: 'æŸ¥çœ‹ç¤¾äº¤åª’ä½“ä¸Šå…³äº {dest} çš„çƒ­é—¨å†…å®¹ï¼š',
                toolsTitle: 'å®ç”¨å·¥å…·',
                toolsDesc: 'ä¸ºæ‚¨çš„ {dest} ä¹‹æ—…æä¾›ä¾¿åˆ©ï¼š',
                
                // åœ°å›¾è¯´æ˜
                mapInstruction: 'ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®åœ¨ç™¾åº¦æˆ–é«˜å¾·åœ°å›¾Appä¸­æŸ¥çœ‹è¯¦ç»†è·¯çº¿',
                mapAdditionalInstruction: 'ä½¿ç”¨ç™¾åº¦æˆ–é«˜å¾·åœ°å›¾è§„åˆ’è·¯çº¿ï¼Œç‚¹å‡»æŒ‰é’®å°†æ‰“å¼€åœ°å›¾Appå¹¶è‡ªåŠ¨è§„åˆ’è·¯çº¿',
                
                // å‡ºè¡Œæ–¹å¼
                modesDriving: 'é©¾è½¦',
                modesWalking: 'æ­¥è¡Œ',
                modesTransit: 'å…¬å…±äº¤é€š',
                modesFlying: 'é£æœº',
                
                // å®ç”¨å·¥å…·
                hotelsText: 'ä½å®¿æŸ¥è¯¢',
                foodSearchText: 'ç¾é£Ÿæ¨è',
                taxiText: 'å‡ºè¡ŒæœåŠ¡',
                moreInfoText: 'æ›´å¤šä¿¡æ¯',
                viewText: 'æŸ¥çœ‹',
                
                // å°è´´å£«
                tipsTitle: 'å°è´´å£«ï¼š',
                tips1: 'æ‰€æœ‰é“¾æ¥å°†åœ¨æ–°æ ‡ç­¾é¡µæ‰“å¼€ï¼Œæ–¹ä¾¿æ‚¨æ¯”è¾ƒå’Œè§„åˆ’ã€‚',
                tips2: 'å‡ºå‘åœ°ï¼š{start} (çº¬åº¦: {lat}, ç»åº¦: {lng})',
                tips3: 'éƒ¨åˆ†æœåŠ¡å¯èƒ½éœ€è¦æ‚¨å®‰è£…ç›¸åº”çš„æ‰‹æœºåº”ç”¨æ‰èƒ½è·å¾—æœ€ä½³ä½“éªŒã€‚',
                
                // é”™è¯¯ä¿¡æ¯
                errorNoDestination: 'è¯·è¾“å…¥ç›®çš„åœ°ï¼',
                errorPlanning: 'å‘ç”Ÿé”™è¯¯ï¼š{error}ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥åé‡è¯•ã€‚',
                errorLocationPermission: 'ä½ç½®æƒé™è¢«æ‹’ç»ï¼Œè¯·åœ¨æµè§ˆå™¨è®¾ç½®ä¸­å…è®¸ä½ç½®è®¿é—®ï¼Œæˆ–é€‰æ‹©çƒ­é—¨åŸå¸‚ã€‚',
                errorLocationUnavailable: 'ä½ç½®ä¿¡æ¯ä¸å¯ç”¨ï¼Œè¯·æ£€æŸ¥è®¾å¤‡å®šä½è®¾ç½®ã€‚',
                errorLocationTimeout: 'è·å–ä½ç½®è¶…æ—¶ï¼Œè¯·æ£€æŸ¥ç½‘ç»œå¹¶é‡è¯•ã€‚'
            },
            
            'zh-TW': {
                // åœ‹éš›ç‰ˆç¹é«”ä¸­æ–‡
                title: 'æ™ºèƒ½æ—…éŠè¡Œç¨‹è¦åŠƒ',
                subtitle: 'å®Œå…¨æœ¬åœ°é‹è¡Œ Â· ç„¡éœ€APIå¯†é‘° Â· å³æ™‚è·¯ç·šè¦åŠƒ Â· æ”¯æŒå…¨çƒç›®çš„åœ°',
                note: 'æœ¬å·¥å…·å®Œå…¨åœ¨æ‚¨çš„ç€è¦½å™¨ä¸­é‹è¡Œï¼Œç„¡éœ€ä»»ä½•APIå¯†é‘°ã€‚æ‰€æœ‰æ•¸æ“šå‡ä¾†è‡ªå…¬é–‹ç¶²çµ¡è³‡æºã€‚',
                
                // åŠŸèƒ½æè¿°
                featureLocation: 'å‡ºç™¼åœ°é¸æ“‡',
                featureLocationDesc: 'å¯é¸æ“‡å¤šå€‹ç†±é–€åŸå¸‚å‡ºç™¼',
                featureRoutes: 'è·¯ç·šè¦åŠƒ',
                featureRoutesDesc: 'æä¾›Googleåœ°åœ–è·¯ç·šè¦åŠƒ',
                featureRecommend: 'ç†±é–€æ¨è–¦',
                featureRecommendDesc: 'æ¨è–¦ç•¶åœ°ç†±é–€æ™¯é»èˆ‡æ´»å‹•',
                featureSocial: 'ç¤¾ç¾¤ç†±é»',
                featureSocialDesc: 'æŸ¥çœ‹ç¤¾äº¤åª’é«”ä¸Šçš„ç†±é–€å…§å®¹',
                
                // ä½ç½®é¸æ“‡
                locationSelectTitle: 'é¸æ“‡å‡ºç™¼åœ°',
                locationSelectDesc: 'è«‹é¸æ“‡æ‚¨çš„å‡ºç™¼åœ°é»ï¼š',
                locationCurrentLabel: 'ä½¿ç”¨æˆ‘çš„ç›®å‰ä½ç½®',
                locationSelectLabel: 'å¾ç†±é–€åŸå¸‚é¸æ“‡',
                cityLocationsLabel: 'é¸æ“‡å‡ºç™¼åŸå¸‚ï¼š',
                updateLocationText: 'æ›´æ–°ä½ç½®',
                resetLocationText: 'é‡ç½®',
                
                // ä½ç½®ç‹€æ…‹
                locationStatusTitle: 'ç›®å‰ä½ç½®ç‹€æ…‹',
                locationStatusText: 'æ­£åœ¨ç²å–æ‚¨çš„ä½ç½®...',
                locationDetailStart: 'å‡ºç™¼åœ°ï¼š',
                locationDetailCoords: 'åº§æ¨™ï¼š',
                
                // ç›®çš„åœ°è¼¸å…¥
                destinationPlaceholder: 'è«‹è¼¸å…¥ç›®çš„åœ°ï¼ˆä¾‹å¦‚ï¼šæ±äº¬æ™´ç©ºå¡”ã€é¦™æ¸¯è¿ªå£«å°¼ã€å°åŒ—101ï¼‰',
                planTripText: 'è¦åŠƒè¡Œç¨‹',
                
                // ç†±é–€ç›®çš„åœ°
                popularDestLabel: 'ç†±é–€ç›®çš„åœ°ï¼š',
                
                // çµæœéƒ¨åˆ†
                loadingText: 'æ­£åœ¨è¦åŠƒæ‚¨çš„è¡Œç¨‹...',
                routesTitle: 'è·¯ç·šè¦åŠƒ',
                routesDesc: 'å¾ {start} å‰å¾€ {dest} çš„è·¯ç·šï¼š',
                recommendationsTitle: 'æœ¬åœ°æ¨è–¦',
                recommendationsDesc: 'ç‚ºæ‚¨æ¨è–¦ {dest} çš„ç†±é–€åœ°é»ï¼š',
                attractionsTitle: 'æ™¯é»',
                attractionsDesc: 'æ¨è–¦æ™¯é»',
                shoppingTitle: 'è³¼ç‰©',
                shoppingDesc: 'æ¨è–¦è³¼ç‰©åœ°é»',
                foodTitle: 'ç¾é£Ÿ',
                foodDesc: 'æ¨è–¦é¤å»³èˆ‡ç¾é£Ÿ',
                accommodationTitle: 'ä½å®¿',
                accommodationDesc: 'æ¨è–¦ä½å®¿',
                socialTitle: 'ç¤¾ç¾¤ç†±é»',
                socialDesc: 'æŸ¥çœ‹ç¤¾äº¤åª’é«”ä¸Šé—œæ–¼ {dest} çš„ç†±é–€å…§å®¹ï¼š',
                toolsTitle: 'å¯¦ç”¨å·¥å…·',
                toolsDesc: 'ç‚ºæ‚¨çš„ {dest} ä¹‹æ—…æä¾›ä¾¿åˆ©ï¼š',
                
                // åœ°åœ–èªªæ˜
                mapInstruction: 'é»æ“Šä¸‹æ–¹æŒ‰éˆ•åœ¨Googleåœ°åœ–ä¸­æŸ¥çœ‹è©³ç´°è·¯ç·š',
                mapAdditionalInstruction: 'ä½¿ç”¨Googleåœ°åœ–è¦åŠƒè·¯ç·šï¼Œé»æ“ŠæŒ‰éˆ•å°‡è·³è½‰åˆ°Googleåœ°åœ–æŸ¥çœ‹è©³ç´°è·¯ç·š',
                
                // å‡ºè¡Œæ–¹å¼
                modesDriving: 'é§•è»Š',
                modesWalking: 'æ­¥è¡Œ',
                modesTransit: 'å…¬å…±äº¤é€š',
                modesFlying: 'é£›æ©Ÿ',
                
                // å¯¦ç”¨å·¥å…·
                hotelsText: 'ä½å®¿æŸ¥è©¢',
                foodSearchText: 'ç¾é£Ÿæ¨è–¦',
                taxiText: 'å‡ºè¡Œæœå‹™',
                moreInfoText: 'æ›´å¤šè³‡è¨Š',
                viewText: 'æŸ¥çœ‹',
                
                // å°è²¼å£«
                tipsTitle: 'å°è²¼å£«ï¼š',
                tips1: 'æ‰€æœ‰é€£çµå°‡åœ¨æ–°æ¨™ç±¤é æ‰“é–‹ï¼Œæ–¹ä¾¿æ‚¨æ¯”è¼ƒå’Œè¦åŠƒã€‚',
                tips2: 'å‡ºç™¼åœ°ï¼š{start} (ç·¯åº¦: {lat}, ç¶“åº¦: {lng})',
                tips3: 'éƒ¨åˆ†æœå‹™å¯èƒ½éœ€è¦æ‚¨å®‰è£ç›¸æ‡‰çš„æ‰‹æ©Ÿæ‡‰ç”¨æ‰èƒ½ç²å¾—æœ€ä½³é«”é©—ã€‚',
                
                // éŒ¯èª¤ä¿¡æ¯
                errorNoDestination: 'è«‹è¼¸å…¥ç›®çš„åœ°ï¼',
                errorPlanning: 'ç™¼ç”ŸéŒ¯èª¤ï¼š{error}ï¼Œè«‹æª¢æŸ¥ç¶²çµ¡é€£æ¥å¾Œé‡è©¦ã€‚',
                errorLocationPermission: 'ä½ç½®æ¬Šé™è¢«æ‹’çµ•ï¼Œè«‹åœ¨ç€è¦½å™¨è¨­å®šä¸­å…è¨±ä½ç½®å­˜å–ï¼Œæˆ–é¸æ“‡ç†±é–€åŸå¸‚ã€‚',
                errorLocationUnavailable: 'ä½ç½®è³‡è¨Šä¸å¯ç”¨ï¼Œè«‹æª¢æŸ¥è¨­å‚™å®šä½è¨­å®šã€‚',
                errorLocationTimeout: 'ç²å–ä½ç½®è¶…æ™‚ï¼Œè«‹æª¢æŸ¥ç¶²çµ¡ä¸¦é‡è©¦ã€‚'
            }
        };
        
        // ç‰ˆæœ¬é…ç½®
        const versionConfig = {
            cn: {
                defaultPosition: { lat: 39.9042, lng: 116.4074 },
                defaultLocationName: "åŒ—äº¬å¸‚ä¸­å¿ƒ",
                
                // ä¸­å›½åŸå¸‚æ•°æ® - ä¸­å›½å†…åœ°ã€é¦™æ¸¯ã€æ¾³é—¨ã€å°æ¹¾äººæœ€å¸¸å»çš„10ä¸ªåŸå¸‚å¸‚ä¸­å¿ƒ
                cities: [
                    { name: "ä¸Šæµ·äººæ°‘å¹¿åœº", lat: 31.2304, lng: 121.4737 },
                    { name: "åŒ—äº¬å¤©å®‰é—¨", lat: 39.9042, lng: 116.4074 },
                    { name: "å¹¿å·å¤©æ²³åŸ", lat: 23.1350, lng: 113.3210 },
                    { name: "æ·±åœ³ç¦ç”°ä¸­å¿ƒ", lat: 22.5431, lng: 114.0555 },
                    { name: "æˆéƒ½æ˜¥ç†™è·¯", lat: 30.6595, lng: 104.0800 },
                    { name: "æ­å·æ¹–æ»¨é“¶æ³°", lat: 30.2570, lng: 120.1650 },
                    { name: "å—äº¬æ–°è¡—å£", lat: 32.0417, lng: 118.7778 },
                    { name: "é¦™æ¸¯å°–æ²™å’€", lat: 22.2980, lng: 114.1720 },
                    { name: "æ¾³é—¨è®®äº‹äº­å‰åœ°", lat: 22.1935, lng: 113.5383 },
                    { name: "å°åŒ—è¥¿é—¨ç”º", lat: 25.0424, lng: 121.5077 }
                ],
                
                // ç¤¾äº¤å¹³å°é…ç½® - ä¸­å›½çƒ­é—¨å¹³å°
                socialPlatforms: [
                    { 
                        name: 'æŠ–éŸ³', 
                        icon: 'fab fa-tiktok', 
                        colorClass: 'douyin-color',
                        url: (keyword) => `https://www.douyin.com/search/${encodeURIComponent(keyword)}?type=video`,
                        description: 'æŸ¥çœ‹æŠ–éŸ³ä¸Šçš„çƒ­é—¨çŸ­è§†é¢‘'
                    },
                    { 
                        name: 'å°çº¢ä¹¦', 
                        icon: 'fas fa-book', 
                        colorClass: 'xiaohongshu-color',
                        url: (keyword) => `https://www.xiaohongshu.com/search_result?keyword=${encodeURIComponent(keyword)}`,
                        description: 'æµè§ˆå°çº¢ä¹¦æ¸¸è®°ä¸æ”»ç•¥'
                    },
                    { 
                        name: 'Bilibili', 
                        icon: 'fas fa-play-circle', 
                        colorClass: 'bilibili-color',
                        url: (keyword) => `https://search.bilibili.com/all?keyword=${encodeURIComponent(keyword)}+æ—…æ¸¸`,
                        description: 'æŸ¥çœ‹Bç«™æ—…æ¸¸ç›¸å…³è§†é¢‘'
                    },
                    { 
                        name: 'å¾®åš', 
                        icon: 'fab fa-weibo', 
                        colorClass: 'weibo-color',
                        url: (keyword) => `https://s.weibo.com/weibo/${encodeURIComponent(keyword)}`,
                        description: 'æœç´¢å¾®åšç›¸å…³è¯é¢˜'
                    },
                    { 
                        name: 'çŸ¥ä¹', 
                        icon: 'fab fa-zhihu', 
                        colorClass: 'zhihu-color',
                        url: (keyword) => `https://www.zhihu.com/search?type=content&q=${encodeURIComponent(keyword)}`,
                        description: 'æŸ¥çœ‹çŸ¥ä¹ä¸Šçš„æ—…æ¸¸é—®ç­”'
                    }
                ],
                
                // åœ°å›¾é…ç½® - ä½¿ç”¨ç™¾åº¦åœ°å›¾å’Œé«˜å¾·åœ°å›¾App
                mapConfig: {
                    getRouteUrl: (origin, destination, mode) => {
                        // ç™¾åº¦åœ°å›¾App URL Scheme
                        const baiduUrl = `baidumap://map/direction?origin=${origin.lat},${origin.lng}&destination=${encodeURIComponent(destination)}&mode=${mode}&src=webapp`;
                        
                        // é«˜å¾·åœ°å›¾App URL Scheme
                        const gaodeUrl = `amapuri://route/plan/?slat=${origin.lat}&slon=${origin.lng}&sname=èµ·ç‚¹&dlat=&dlon=&dname=${encodeURIComponent(destination)}&dev=0&t=0`;
                        
                        return { baiduUrl, gaodeUrl };
                    },
                    
                    searchUrl: (query) => `https://www.baidu.com/s?wd=${encodeURIComponent(query)}`
                },
                
                // å®ç”¨æœåŠ¡é…ç½®
                services: {
                    hotels: (destination) => `https://hotels.ctrip.com/hotels/list?keyword=${encodeURIComponent(destination)}`,
                    food: (destination) => `https://www.dianping.com/search/keyword/1/0_${encodeURIComponent(destination)}`,
                    taxi: () => `https://page.xiaojukeji.com/m/didi-index.html`,
                    flights: (destination) => `https://flights.ctrip.com/online/channel/international?keyword=${encodeURIComponent(destination)}`
                },
                
                // çƒ­é—¨ç›®çš„åœ°
                popularDestinations: ['åŒ—äº¬æ•…å®«', 'ä¸Šæµ·å¤–æ»©', 'å¹¿å·å¡”', 'è¥¿å®‰å…µé©¬ä¿‘', 'æˆéƒ½å®½çª„å··å­', 'é¦™æ¸¯è¿ªå£«å°¼', 'æ¾³é—¨å¤§ä¸‰å·´', 'å°åŒ—101', 'æ­å·è¥¿æ¹–', 'å—äº¬å¤«å­åº™']
            },
            
            intl: {
                defaultPosition: { lat: 22.1568, lng: 113.5610 },
                defaultLocationName: "æ¾³é—¨æ°¹ä»”ä¸­å¤®å…¬å›­",
                
                // å›½é™…åŸå¸‚æ•°æ®
                cities: [
                    { name: "æ¾³é—¨æ°¹ä»”ä¸­å¤®å…¬å›­", lat: 22.1568, lng: 113.5610 },
                    { name: "é¦™æ¸¯å¸‚ä¸­å¿ƒ", lat: 22.3193, lng: 114.1694 },
                    { name: "ä¸œäº¬å¸‚ä¸­å¿ƒ", lat: 35.6762, lng: 139.6503 },
                    { name: "é¦–å°”å¸‚ä¸­å¿ƒ", lat: 37.5665, lng: 126.9780 },
                    { name: "æ–°åŠ å¡å¸‚ä¸­å¿ƒ", lat: 1.3521, lng: 103.8198 },
                    { name: "æ›¼è°·å¸‚ä¸­å¿ƒ", lat: 13.7563, lng: 100.5018 },
                    { name: "å°åŒ—å¸‚ä¸­å¿ƒ", lat: 25.0330, lng: 121.5654 },
                    { name: "æ‚‰å°¼å¸‚ä¸­å¿ƒ", lat: -33.8688, lng: 151.2093 },
                    { name: "ä¼¦æ•¦å¸‚ä¸­å¿ƒ", lat: 51.5074, lng: -0.1278 },
                    { name: "çº½çº¦å¸‚ä¸­å¿ƒ", lat: 40.7128, lng: -74.0060 }
                ],
                
                // ç¤¾äº¤å¹³å°é…ç½® - å›½é™…çƒ­é—¨å¹³å°
                socialPlatforms: [
                    { 
                        name: 'Facebook', 
                        icon: 'fab fa-facebook-f', 
                        colorClass: 'facebook-color',
                        url: (keyword) => `https://www.facebook.com/search/top/?q=${encodeURIComponent(keyword)}`,
                        description: 'Search Facebook content'
                    },
                    { 
                        name: 'Instagram', 
                        icon: 'fab fa-instagram', 
                        colorClass: 'instagram-color',
                        url: (keyword) => `https://www.instagram.com/explore/tags/${encodeURIComponent(keyword.replace(/ /g, ''))}/`,
                        description: 'Browse Instagram photos'
                    },
                    { 
                        name: 'Twitter', 
                        icon: 'fab fa-twitter', 
                        colorClass: 'twitter-color',
                        url: (keyword) => `https://twitter.com/search?q=${encodeURIComponent(keyword)}&src=typed_query`,
                        description: 'View Twitter updates'
                    },
                    { 
                        name: 'YouTube', 
                        icon: 'fab fa-youtube', 
                        colorClass: 'youtube-color',
                        url: (keyword) => `https://www.youtube.com/results?search_query=${encodeURIComponent(keyword)}+travel`,
                        description: 'Watch YouTube travel videos'
                    },
                    { 
                        name: 'Tripadvisor', 
                        icon: 'fas fa-suitcase-rolling', 
                        colorClass: 'tripadvisor-color',
                        url: (keyword) => `https://www.tripadvisor.com/Search?q=${encodeURIComponent(keyword)}`,
                        description: 'View travel reviews'
                    }
                ],
                
                // åœ°å›¾é…ç½® - Google Maps
                mapConfig: {
                    getRouteUrl: (origin, destination, mode) => {
                        // Google Mapsè·¯çº¿è§„åˆ’
                        return `https://www.google.com/maps/dir/?api=1&origin=${origin.lat},${origin.lng}&destination=${encodeURIComponent(destination)}&travelmode=${mode}`;
                    },
                    
                    searchUrl: (query) => `https://www.google.com/search?q=${encodeURIComponent(query)}`
                },
                
                // å®ç”¨æœåŠ¡é…ç½®
                services: {
                    hotels: (destination) => `https://www.booking.com/searchresults.html?ss=${encodeURIComponent(destination)}`,
                    food: (destination) => `https://www.google.com/search?q=${encodeURIComponent(destination)}+restaurants`,
                    taxi: () => `https://www.uber.com/`,
                    flights: (destination) => `https://www.skyscanner.com/transport/flights/${encodeURIComponent(destination)}`
                },
                
                // çƒ­é—¨ç›®çš„åœ°
                popularDestinations: ['Tokyo Skytree', 'Hong Kong Disneyland', 'Singapore Gardens by the Bay', 'Bangkok Grand Palace', 'Taipei 101', 'Sydney Opera House', 'London Eye', 'New York Times Square', 'Paris Eiffel Tower', 'Seoul Myeongdong']
            }
        };
        
        // è·å–å½“å‰ç‰ˆæœ¬é…ç½®
        function getCurrentConfig() {
            return versionConfig[currentVersion];
        }
        
        // è·å–å½“å‰è¯­è¨€æ–‡æœ¬
        function getText(key, params = {}) {
            const text = languageTexts[currentLanguage][key] || key;
            
            // æ›¿æ¢å‚æ•°
            let result = text;
            for (const param in params) {
                result = result.replace(new RegExp(`{${param}}`, 'g'), params[param]);
            }
            
            return result;
        }
        
        // åˆ‡æ¢ç‰ˆæœ¬
        function switchVersion(version) {
            currentVersion = version;
            
            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            document.getElementById('cn-version-btn').classList.toggle('active', version === 'cn');
            document.getElementById('intl-version-btn').classList.toggle('active', version === 'intl');
            
            // è‡ªåŠ¨åˆ‡æ¢è¯­è¨€ï¼šä¸­å›½ç‰ˆç”¨ç®€ä½“ï¼Œå›½é™…ç‰ˆç”¨ç¹ä½“
            if (version === 'cn') {
                switchLanguage('zh-CN');
            } else {
                switchLanguage('zh-TW');
            }
            
            // æ›´æ–°é¡µé¢æ–‡æœ¬
            updatePageText();
            
            // æ›´æ–°åŸå¸‚é€‰æ‹©ä¸‹æ‹‰èœå•
            updateCitySelect();
            
            // æ›´æ–°çƒ­é—¨ç›®çš„åœ°æŒ‰é’®
            updatePopularDestinations();
            
            // é‡ç½®ä½ç½®ä¸ºé»˜è®¤ä½ç½®
            resetToDefaultLocation();
        }
        
        // åˆ‡æ¢è¯­è¨€
        function switchLanguage(lang) {
            currentLanguage = lang;
            
            // æ›´æ–°è¯­è¨€æŒ‰é’®çŠ¶æ€
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            const activeBtn = Array.from(document.querySelectorAll('.lang-btn')).find(btn => {
                return (lang === 'zh-CN' && btn.textContent === 'ç®€ä½“') ||
                       (lang === 'zh-TW' && btn.textContent === 'ç¹é«”');
            });
            if (activeBtn) activeBtn.classList.add('active');
            
            // æ›´æ–°é¡µé¢æ–‡æœ¬
            updatePageText();
            
            // æ›´æ–°çƒ­é—¨ç›®çš„åœ°æŒ‰é’®
            updatePopularDestinations();
        }
        
        // æ›´æ–°é¡µé¢æ–‡æœ¬
        function updatePageText() {
            // æ›´æ–°æ ‡é¢˜
            document.title = getText('title');
            document.getElementById('main-title').innerHTML = `<i class="fas fa-plane-departure"></i> ${getText('title')}`;
            document.getElementById('version-subtitle').textContent = getText('subtitle');
            document.getElementById('version-note').textContent = getText('note');
            
            // æ›´æ–°åŠŸèƒ½æè¿°
            document.getElementById('feature-location').textContent = getText('featureLocation');
            document.getElementById('feature-location-desc').textContent = getText('featureLocationDesc');
            document.getElementById('feature-routes').textContent = getText('featureRoutes');
            document.getElementById('feature-routes-desc').textContent = getText('featureRoutesDesc');
            document.getElementById('feature-recommend').textContent = getText('featureRecommend');
            document.getElementById('feature-recommend-desc').textContent = getText('featureRecommendDesc');
            document.getElementById('feature-social').textContent = getText('featureSocial');
            document.getElementById('feature-social-desc').textContent = getText('featureSocialDesc');
            
            // æ›´æ–°ä½ç½®é€‰æ‹©
            document.getElementById('location-select-title').textContent = getText('locationSelectTitle');
            document.getElementById('location-select-desc').textContent = getText('locationSelectDesc');
            document.getElementById('location-current-label').textContent = getText('locationCurrentLabel');
            document.getElementById('location-select-label').textContent = getText('locationSelectLabel');
            document.getElementById('city-locations-label').textContent = getText('cityLocationsLabel');
            document.getElementById('update-location-text').textContent = getText('updateLocationText');
            document.getElementById('reset-location-text').textContent = getText('resetLocationText');
            
            // æ›´æ–°ä½ç½®çŠ¶æ€
            document.getElementById('location-status-title').textContent = getText('locationStatusTitle');
            document.getElementById('location-detail-start').textContent = getText('locationDetailStart');
            document.getElementById('location-detail-coords').textContent = getText('locationDetailCoords');
            
            // æ›´æ–°ç›®çš„åœ°è¾“å…¥
            document.getElementById('destination').placeholder = getText('destinationPlaceholder');
            document.getElementById('plan-trip-text').textContent = getText('planTripText');
            
            // æ›´æ–°çƒ­é—¨ç›®çš„åœ°
            document.getElementById('popular-dest-label').textContent = getText('popularDestLabel');
        }
        
        // æ›´æ–°åŸå¸‚é€‰æ‹©ä¸‹æ‹‰èœå•
        function updateCitySelect() {
            const config = getCurrentConfig();
            const citySelect = document.getElementById('city-locations');
            citySelect.innerHTML = '';
            
            config.cities.forEach(city => {
                const option = document.createElement('option');
                option.value = `${city.lat},${city.lng},${city.name}`;
                option.textContent = city.name;
                citySelect.appendChild(option);
            });
        }
        
        // æ›´æ–°çƒ­é—¨ç›®çš„åœ°æŒ‰é’®
        function updatePopularDestinations() {
            const popularDestContainer = document.querySelector('.popular-destinations');
            // æ¸…é™¤ç°æœ‰æŒ‰é’®ï¼ˆä¿ç•™æ ‡ç­¾ï¼‰
            const label = popularDestContainer.querySelector('#popular-dest-label');
            popularDestContainer.innerHTML = '';
            popularDestContainer.appendChild(label);
            
            // æ ¹æ®ç‰ˆæœ¬è·å–çƒ­é—¨ç›®çš„åœ°
            const config = getCurrentConfig();
            const popularDests = config.popularDestinations || [];
            
            popularDests.forEach(destination => {
                const btn = document.createElement('button');
                btn.className = 'popular-btn';
                btn.textContent = destination;
                btn.onclick = () => setDestination(destination);
                popularDestContainer.appendChild(btn);
            });
        }
        
        // è·å–ç”¨æˆ·ä½ç½®
        function getUserLocation() {
            return new Promise((resolve, reject) => {
                const config = getCurrentConfig();
                
                if (navigator.geolocation) {
                    // å…ˆæ˜¾ç¤ºè·å–ä½ç½®çŠ¶æ€
                    updateLocationStatus("info", `<i class="fas fa-sync fa-spin"></i> ${getText('locationStatusText')}`);
                    
                    navigator.geolocation.getCurrentPosition(
                        (position) => {
                            userPosition = {
                                lat: position.coords.latitude.toFixed(6),
                                lng: position.coords.longitude.toFixed(6)
                            };
                            
                            // æ›´æ–°ä½ç½®çŠ¶æ€æ˜¾ç¤º
                            updateLocationStatus("success", `<i class="fas fa-check-circle"></i> å·²è·å–æ‚¨çš„ä½ç½®ï¼šçº¬åº¦ ${userPosition.lat}, ç»åº¦ ${userPosition.lng}`);
                            
                            // æ›´æ–°ä½ç½®è¯¦æƒ…æ˜¾ç¤º
                            updateLocationDetails("æ‚¨çš„ä½ç½®", userPosition.lat, userPosition.lng);
                            
                            // è‡ªåŠ¨é€‰ä¸­"ä½¿ç”¨æˆ‘çš„å½“å‰ä½ç½®"é€‰é¡¹
                            document.getElementById('location-current').checked = true;
                            document.getElementById('custom-location-selector').style.display = 'none';
                            document.getElementById('current-location-option').classList.add('active');
                            document.getElementById('select-location-option').classList.remove('active');
                            
                            resolve(userPosition);
                        },
                        (error) => {
                            console.log('ä½ç½®è·å–å¤±è´¥:', error);
                            let message = '';
                            switch(error.code) {
                                case error.PERMISSION_DENIED:
                                    message = getText('errorLocationPermission');
                                    break;
                                case error.POSITION_UNAVAILABLE:
                                    message = getText('errorLocationUnavailable');
                                    break;
                                case error.TIMEOUT:
                                    message = getText('errorLocationTimeout');
                                    break;
                                default:
                                    message = `è·å–ä½ç½®å¤±è´¥ï¼Œä½¿ç”¨é»˜è®¤ä½ç½®ï¼š${config.defaultLocationName}ã€‚`;
                            }
                            
                            // ä½¿ç”¨é»˜è®¤ä½ç½®
                            userPosition = config.defaultPosition;
                            updateLocationStatus("warning", `<i class="fas fa-exclamation-triangle"></i> ${message}`);
                            updateLocationDetails(config.defaultLocationName, userPosition.lat, userPosition.lng);
                            
                            // è‡ªåŠ¨åˆ‡æ¢åˆ°é€‰æ‹©åœ°ç‚¹æ¨¡å¼
                            document.getElementById('location-select').checked = true;
                            document.getElementById('custom-location-selector').style.display = 'block';
                            document.getElementById('current-location-option').classList.remove('active');
                            document.getElementById('select-location-option').classList.add('active');
                            
                            resolve(userPosition);
                        },
                        { 
                            timeout: 10000,
                            enableHighAccuracy: true,
                            maximumAge: 0
                        }
                    );
                } else {
                    userPosition = config.defaultPosition;
                    updateLocationStatus("warning", `<i class="fas fa-exclamation-triangle"></i> æµè§ˆå™¨ä¸æ”¯æŒå®šä½æœåŠ¡ï¼Œä½¿ç”¨é»˜è®¤ä½ç½®ï¼š${config.defaultLocationName}ã€‚`);
                    updateLocationDetails(config.defaultLocationName, userPosition.lat, userPosition.lng);
                    
                    // è‡ªåŠ¨åˆ‡æ¢åˆ°é€‰æ‹©åœ°ç‚¹æ¨¡å¼
                    document.getElementById('location-select').checked = true;
                    document.getElementById('custom-location-selector').style.display = 'block';
                    document.getElementById('current-location-option').classList.remove('active');
                    document.getElementById('select-location-option').classList.add('active');
                    
                    resolve(userPosition);
                }
            });
        }
        
        // æ›´æ–°ä½ç½®çŠ¶æ€æ˜¾ç¤º
        function updateLocationStatus(type, message) {
            const status = document.getElementById('location-status');
            status.innerHTML = message;
            status.className = `location-status ${type}`;
        }
        
        // æ›´æ–°ä½ç½®è¯¦æƒ…æ˜¾ç¤º
        function updateLocationDetails(name, lat, lng) {
            document.getElementById('current-location-name').textContent = name;
            document.getElementById('current-coordinates').textContent = `çº¬åº¦ ${lat}, ç»åº¦ ${lng}`;
        }
        
        // è®¾ç½®ç›®çš„åœ°
        function setDestination(dest) {
            document.getElementById('destination').value = dest;
            planTrip();
        }
        
        // å¤„ç†æŒ‰é”®äº‹ä»¶
        function handleKeyPress(event) {
            if (event.key === 'Enter') planTrip();
        }
        
        // æ›´æ–°ä½ç½®ï¼ˆæ ¹æ®ç”¨æˆ·é€‰æ‹©ï¼‰
        function updateLocation() {
            const useCurrentLocation = document.getElementById('location-current').checked;
            
            if (useCurrentLocation) {
                // ä½¿ç”¨å½“å‰ä½ç½®
                updateLocationStatus("info", `<i class="fas fa-sync fa-spin"></i> ${getText('locationStatusText')}`);
                getUserLocation();
            } else {
                // ä½¿ç”¨é€‰æ‹©çš„åŸå¸‚åœ°ç‚¹
                const selectElement = document.getElementById('city-locations');
                const selectedValue = selectElement.value;
                const [lat, lng, name] = selectedValue.split(',');
                
                userPosition = { lat: parseFloat(lat), lng: parseFloat(lng) };
                
                updateLocationStatus("success", `<i class="fas fa-check-circle"></i> å·²é€‰æ‹©å‡ºå‘åœ°ï¼š${name}`);
                updateLocationDetails(name, userPosition.lat, userPosition.lng);
            }
        }
        
        // é‡ç½®ä¸ºé»˜è®¤ä½ç½®
        function resetToDefaultLocation() {
            const config = getCurrentConfig();
            userPosition = config.defaultPosition;
            updateLocationStatus("info", `<i class="fas fa-info-circle"></i> å·²é‡ç½®ä¸ºé»˜è®¤ä½ç½®ï¼š${config.defaultLocationName}`);
            updateLocationDetails(config.defaultLocationName, userPosition.lat, userPosition.lng);
            
            // é‡ç½®é€‰æ‹©
            document.getElementById('location-current').checked = true;
            document.getElementById('custom-location-selector').style.display = 'none';
            document.getElementById('current-location-option').classList.add('active');
            document.getElementById('select-location-option').classList.remove('active');
        }
        
        // åˆ›å»ºæ¨èé¡¹ç›®HTML
        function createRecommendationHTML(category, destination) {
            const config = getCurrentConfig();
            const searchQueries = {
                attractions: currentVersion === 'cn' ? `${destination} æ™¯ç‚¹æ¨è` : `${destination} attractions`,
                shopping: currentVersion === 'cn' ? `${destination} è´­ç‰©æ¨è` : `${destination} shopping places`,
                food: currentVersion === 'cn' ? `${destination} ç¾é£Ÿæ¨è` : `${destination} restaurants`,
                accommodation: currentVersion === 'cn' ? `${destination} ä½å®¿æ¨è` : `${destination} hotels`
            };
            
            const query = searchQueries[category];
            return `
                <div class="recommendation-item">
                    <span>${getText(category + 'Desc')}</span>
                    <a href="${config.mapConfig.searchUrl(query)}" target="_blank" rel="noopener noreferrer">
                        ${getText('moreInfoText')}
                    </a>
                </div>
            `;
        }
        
        // åˆ›å»ºç¤¾äº¤å¹³å°HTML
        function createSocialPlatformsHTML(destination) {
            const config = getCurrentConfig();
            return config.socialPlatforms.map(platform => `
                <div class="social-item">
                    <div class="social-name">
                        <div class="social-icon">
                            <i class="${platform.icon}"></i>
                        </div>
                        <div>
                            <strong>${platform.name}</strong>
                            <div style="font-size: 0.8em; color: #666;">${platform.description}</div>
                        </div>
                    </div>
                    <a href="${platform.url(destination)}" target="_blank" rel="noopener noreferrer" class="${platform.colorClass}" style="color: white;">
                        ${getText('viewText')}
                    </a>
                </div>
            `).join('');
        }
        
        // åˆ›å»ºè·¯çº¿è§„åˆ’HTML
        function createRouteHTML(startLocationName, destination) {
            const config = getCurrentConfig();
            const modes = [
                { name: getText('modesDriving'), icon: 'fa-car', mode: 'driving' },
                { name: getText('modesWalking'), icon: 'fa-walking', mode: 'walking' },
                { name: getText('modesTransit'), icon: 'fa-bus', mode: 'transit' },
                { name: getText('modesFlying'), icon: 'fa-plane', mode: 'flying' }
            ];
            
            let mapButtonsHTML = '';
            
            if (currentVersion === 'cn') {
                // ä¸­å›½ç‰ˆæ˜¾ç¤ºç™¾åº¦åœ°å›¾å’Œé«˜å¾·åœ°å›¾æŒ‰é’®
                mapButtonsHTML = `
                    <div class="map-buttons">
                        <button class="map-app-btn baidu-map-btn" onclick="openBaiduMap('${destination}')">
                            <i class="fas fa-map"></i> ç™¾åº¦åœ°å›¾
                        </button>
                        <button class="map-app-btn gaode-map-btn" onclick="openGaodeMap('${destination}')">
                            <i class="fas fa-map-marked-alt"></i> é«˜å¾·åœ°å›¾
                        </button>
                    </div>
                    <div class="mode-selector">
                        ${modes.map(mode => `
                            <button class="mode-btn" onclick="openMapWithMode('${destination}', '${mode.mode}')">
                                <i class="fas ${mode.icon}"></i> ${mode.name}
                            </button>
                        `).join('')}
                    </div>
                `;
            } else {
                // å›½é™…ç‰ˆæ˜¾ç¤ºGoogleåœ°å›¾æŒ‰é’®
                mapButtonsHTML = `
                    <div class="map-buttons">
                        <button class="map-app-btn google-map-btn" onclick="openGoogleMap('${destination}')">
                            <i class="fab fa-google"></i> Googleåœ°å›¾
                        </button>
                    </div>
                    <div class="mode-selector">
                        ${modes.map(mode => `
                            <button class="mode-btn" onclick="openGoogleMapWithMode('${destination}', '${mode.mode}')">
                                <i class="fas ${mode.icon}"></i> ${mode.name}
                            </button>
                        `).join('')}
                    </div>
                `;
            }
            
            return `
                <p style="margin-bottom: 15px;">${getText('mapInstruction')}</p>
                ${mapButtonsHTML}
                <div class="map-instruction" style="margin-top: 15px; padding: 10px; background: #f8f9fa; border-radius: 8px;">
                    <i class="fas fa-info-circle"></i> ${getText('mapAdditionalInstruction')}
                </div>
            `;
        }
        
        // æ‰“å¼€ç™¾åº¦åœ°å›¾
        function openBaiduMap(destination) {
            const config = getCurrentConfig();
            const baiduUrl = `baidumap://map/direction?origin=${userPosition.lat},${userPosition.lng}&destination=${encodeURIComponent(destination)}&mode=driving&src=webapp`;
            const webUrl = `https://map.baidu.com/dir/?origin=${userPosition.lat},${userPosition.lng}&destination=${encodeURIComponent(destination)}&mode=driving`;
            
            // å°è¯•æ‰“å¼€Appï¼Œå¦‚æœå¤±è´¥åˆ™æ‰“å¼€ç½‘é¡µç‰ˆ
            window.location.href = baiduUrl;
            setTimeout(() => {
                window.open(webUrl, '_blank');
            }, 500);
        }
        
        // æ‰“å¼€é«˜å¾·åœ°å›¾
        function openGaodeMap(destination) {
            const gaodeUrl = `amapuri://route/plan/?slat=${userPosition.lat}&slon=${userPosition.lng}&sname=èµ·ç‚¹&dlat=&dlon=&dname=${encodeURIComponent(destination)}&dev=0&t=0`;
            const webUrl = `https://uri.amap.com/navigation?from=${userPosition.lng},${userPosition.lat}&to=${encodeURIComponent(destination)}&mode=car`;
            
            // å°è¯•æ‰“å¼€Appï¼Œå¦‚æœå¤±è´¥åˆ™æ‰“å¼€ç½‘é¡µç‰ˆ
            window.location.href = gaodeUrl;
            setTimeout(() => {
                window.open(webUrl, '_blank');
            }, 500);
        }
        
        // æ‰“å¼€Googleåœ°å›¾
        function openGoogleMap(destination) {
            const url = `https://www.google.com/maps/dir/?api=1&origin=${userPosition.lat},${userPosition.lng}&destination=${encodeURIComponent(destination)}&travelmode=driving`;
            window.open(url, '_blank');
        }
        
        // æ‰“å¼€Googleåœ°å›¾ï¼ˆå¸¦æ¨¡å¼ï¼‰
        function openGoogleMapWithMode(destination, mode) {
            const url = `https://www.google.com/maps/dir/?api=1&origin=${userPosition.lat},${userPosition.lng}&destination=${encodeURIComponent(destination)}&travelmode=${mode}`;
            window.open(url, '_blank');
        }
        
        // æ‰“å¼€åœ°å›¾ï¼ˆå¸¦æ¨¡å¼ï¼‰- ä¸­å›½ç‰ˆ
        function openMapWithMode(destination, mode) {
            const baiduUrl = `baidumap://map/direction?origin=${userPosition.lat},${userPosition.lng}&destination=${encodeURIComponent(destination)}&mode=${mode}&src=webapp`;
            const webUrl = `https://map.baidu.com/dir/?origin=${userPosition.lat},${userPosition.lng}&destination=${encodeURIComponent(destination)}&mode=${mode}`;
            
            // å°è¯•æ‰“å¼€Appï¼Œå¦‚æœå¤±è´¥åˆ™æ‰“å¼€ç½‘é¡µç‰ˆ
            window.location.href = baiduUrl;
            setTimeout(() => {
                window.open(webUrl, '_blank');
            }, 500);
        }
        
        // è§„åˆ’è¡Œç¨‹ä¸»å‡½æ•°
        async function planTrip() {
            const destination = document.getElementById('destination').value.trim();
            const planBtn = document.getElementById('plan-btn');
            
            if (!destination) {
                alert(getText('errorNoDestination'));
                return;
            }
            
            // ç¦ç”¨æŒ‰é’®é˜²æ­¢é‡å¤ç‚¹å‡»
            planBtn.disabled = true;
            planBtn.innerHTML = `<i class="fas fa-spinner fa-spin"></i> ${getText('planTripText')}`;
            
            try {
                const resultsDiv = document.getElementById('results');
                resultsDiv.innerHTML = `<div class="loading">${getText('loadingText')}</div>`;
                
                // ç¡®ä¿æœ‰ä½ç½®ä¿¡æ¯
                if (!userPosition) {
                    await getUserLocation();
                }
                
                const config = getCurrentConfig();
                
                // æ˜¾ç¤ºç»“æœ
                resultsDiv.innerHTML = '';
                
                // è·å–å‡ºå‘åœ°åç§°
                const startLocationName = document.getElementById('current-location-name').textContent;
                
                // è·¯çº¿è§„åˆ’éƒ¨åˆ†
                const routesSection = document.createElement('div');
                routesSection.className = 'section section-routes';
                routesSection.innerHTML = `
                    <h2><i class="fas fa-route"></i> ${getText('routesTitle')}</h2>
                    <p>${getText('routesDesc', {start: startLocationName, dest: destination})}</p>
                    ${createRouteHTML(startLocationName, destination)}
                `;
                resultsDiv.appendChild(routesSection);
                
                // æœ¬åœ°æ¨èéƒ¨åˆ†
                const recommendationsSection = document.createElement('div');
                recommendationsSection.className = 'section section-rankings';
                recommendationsSection.innerHTML = `
                    <h2><i class="fas fa-star"></i> ${getText('recommendationsTitle')}</h2>
                    <p>${getText('recommendationsDesc', {dest: destination})}</p>
                    
                    <h3><span class="category-tag tag-attractions">${getText('attractionsTitle')}</span> ${getText('attractionsDesc')}</h3>
                    <div class="recommendations-grid">
                        ${createRecommendationHTML('attractions', destination)}
                    </div>
                    
                    <h3><span class="category-tag tag-shopping">${getText('shoppingTitle')}</span> ${getText('shoppingDesc')}</h3>
                    <div class="recommendations-grid">
                        ${createRecommendationHTML('shopping', destination)}
                    </div>
                    
                    <h3><span class="category-tag tag-food">${getText('foodTitle')}</span> ${getText('foodDesc')}</h3>
                    <div class="recommendations-grid">
                        ${createRecommendationHTML('food', destination)}
                    </div>
                    
                    <h3><span class="category-tag tag-accommodation">${getText('accommodationTitle')}</span> ${getText('accommodationDesc')}</h3>
                    <div class="recommendations-grid">
                        ${createRecommendationHTML('accommodation', destination)}
                    </div>
                `;
                resultsDiv.appendChild(recommendationsSection);
                
                // ç¤¾äº¤çƒ­ç‚¹éƒ¨åˆ†
                const socialSection = document.createElement('div');
                socialSection.className = 'section section-social';
                socialSection.innerHTML = `
                    <h2><i class="fas fa-hashtag"></i> ${getText('socialTitle')}</h2>
                    <p>${getText('socialDesc', {dest: destination})}</p>
                    <div class="social-grid">
                        ${createSocialPlatformsHTML(destination)}
                    </div>
                `;
                resultsDiv.appendChild(socialSection);
                
                // å®ç”¨å·¥å…·éƒ¨åˆ†
                const toolsSection = document.createElement('div');
                toolsSection.className = 'section section-tools';
                toolsSection.innerHTML = `
                    <h2><i class="fas fa-tools"></i> ${getText('toolsTitle')}</h2>
                    <p>${getText('toolsDesc', {dest: destination})}</p>
                    <div class="recommendations-grid">
                        <div class="recommendation-item">
                            <span><i class="fas fa-bed"></i> ${getText('hotelsText')}</span>
                            <a href="${config.services.hotels(destination)}" target="_blank" rel="noopener noreferrer">
                                ${currentVersion === 'cn' ? 'æºç¨‹' : 'Booking'}
                            </a>
                        </div>
                        <div class="recommendation-item">
                            <span><i class="fas fa-utensils"></i> ${getText('foodSearchText')}</span>
                            <a href="${config.services.food(destination)}" target="_blank" rel="noopener noreferrer">
                                ${currentVersion === 'cn' ? 'å¤§ä¼—ç‚¹è¯„' : 'Food Search'}
                            </a>
                        </div>
                        <div class="recommendation-item">
                            <span><i class="fas fa-taxi"></i> ${getText('taxiText')}</span>
                            <a href="${config.services.taxi()}" target="_blank" rel="noopener noreferrer">
                                ${currentVersion === 'cn' ? 'æ»´æ»´' : 'Uber'}
                            </a>
                        </div>
                        <div class="recommendation-item">
                            <span><i class="fas fa-info-circle"></i> ${getText('moreInfoText')}</span>
                            <a href="${config.mapConfig.searchUrl(destination + ' ' + (currentVersion === 'cn' ? 'æ—…æ¸¸æ”»ç•¥' : 'travel guide'))}" target="_blank" rel="noopener noreferrer">
                                ${getText('moreInfoText')}
                            </a>
                        </div>
                    </div>
                    <div style="margin-top: 20px; padding: 15px; background: #f8f9fa; border-radius: 8px;">
                        <p><strong><i class="fas fa-lightbulb"></i> ${getText('tipsTitle')}</strong> ${getText('tips1')}</p>
                        <p><strong><i class="fas fa-map-marker-alt"></i> ${getText('tips2', {start: startLocationName, lat: userPosition.lat, lng: userPosition.lng})}</p>
                        <p><strong><i class="fas fa-info-circle"></i> ${getText('tips3')}</p>
                    </div>
                `;
                resultsDiv.appendChild(toolsSection);
                
                // æ»šåŠ¨åˆ°ç»“æœåŒºåŸŸ
                resultsDiv.scrollIntoView({ behavior: 'smooth', block: 'start' });
                
            } catch (error) {
                console.error('è¡Œç¨‹è§„åˆ’é”™è¯¯:', error);
                document.getElementById('results').innerHTML = `
                    <div class="location-status error">
                        <i class="fas fa-exclamation-circle"></i> <strong>${getText('errorPlanning', {error: error.message})}</strong>
                    </div>
                `;
            } finally {
                // é‡æ–°å¯ç”¨æŒ‰é’®
                planBtn.disabled = false;
                planBtn.innerHTML = `<i class="fas fa-search"></i> ${getText('planTripText')}`;
            }
        }
        
        // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–
        window.addEventListener('DOMContentLoaded', async () => {
            try {
                // è®¾ç½®ä½ç½®é€‰æ‹©çš„äº‹ä»¶ç›‘å¬å™¨
                document.getElementById('location-current').addEventListener('change', function() {
                    if (this.checked) {
                        document.getElementById('custom-location-selector').style.display = 'none';
                        document.getElementById('current-location-option').classList.add('active');
                        document.getElementById('select-location-option').classList.remove('active');
                        updateLocation();
                    }
                });
                
                document.getElementById('location-select').addEventListener('change', function() {
                    if (this.checked) {
                        document.getElementById('custom-location-selector').style.display = 'block';
                        document.getElementById('current-location-option').classList.remove('active');
                        document.getElementById('select-location-option').classList.add('active');
                        updateLocation();
                    }
                });
                
                // åŸå¸‚åœ°ç‚¹é€‰æ‹©å˜æ›´äº‹ä»¶
                document.getElementById('city-locations').addEventListener('change', function() {
                    updateLocation();
                });
                
                // åˆå§‹è·å–ä½ç½®
                await getUserLocation();
                
                // åˆå§‹åŒ–ç‰ˆæœ¬åˆ‡æ¢
                switchVersion('cn');
                
                // æ›´æ–°é¡µé¢æ–‡æœ¬
                updatePageText();
                
            } catch (error) {
                console.error('åˆå§‹åŒ–é”™è¯¯:', error);
            }
        });
    </script>
</body>
</html>
